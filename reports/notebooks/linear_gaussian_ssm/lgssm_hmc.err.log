Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
sample_size = 500
param_samples, lps = fit_hmc(test_model, initial_params, param_props, next(keys), sample_size, emissions, num_integration_steps=30)
------------------

----- stdout -----
Running window adaptation
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[10], line 2[0m
[1;32m      1[0m sample_size [38;5;241m=[39m [38;5;241m500[39m
[0;32m----> 2[0m param_samples, lps [38;5;241m=[39m [43mfit_hmc[49m[43m([49m[43mtest_model[49m[43m,[49m[43m [49m[43minitial_params[49m[43m,[49m[43m [49m[43mparam_props[49m[43m,[49m[43m [49m[38;5;28;43mnext[39;49m[43m([49m[43mkeys[49m[43m)[49m[43m,[49m[43m [49m[43msample_size[49m[43m,[49m[43m [49m[43memissions[49m[43m,[49m[43m [49m[43mnum_integration_steps[49m[38;5;241;43m=[39;49m[38;5;241;43m30[39;49m[43m)[49m

Cell [0;32mIn[9], line 38[0m, in [0;36mfit_hmc[0;34m(model, initial_params, props, key, num_samples, emissions, inputs, warmup_steps, num_integration_steps, verbose)[0m
[1;32m     32[0m warmup [38;5;241m=[39m blackjax[38;5;241m.[39mwindow_adaptation(blackjax[38;5;241m.[39mhmc,
[1;32m     33[0m                                     _logprob,
[1;32m     34[0m                                     num_steps[38;5;241m=[39mwarmup_steps,
[1;32m     35[0m                                     num_integration_steps[38;5;241m=[39mnum_integration_steps,
[1;32m     36[0m                                     progress_bar[38;5;241m=[39mverbose)
[1;32m     37[0m init_key, key [38;5;241m=[39m jr[38;5;241m.[39msplit(key)
[0;32m---> 38[0m hmc_initial_state, hmc_kernel, _ [38;5;241m=[39m [43mwarmup[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43minit_key[49m[43m,[49m[43m [49m[43minitial_unc_params[49m[43m)[49m
[1;32m     40[0m [38;5;129m@jit[39m
[1;32m     41[0m [38;5;28;01mdef[39;00m [38;5;21mhmc_step[39m(hmc_state, step_key):
[1;32m     42[0m     next_hmc_state, _ [38;5;241m=[39m hmc_kernel(step_key, hmc_state)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/blackjax/adaptation/window_adaptation.py:335[0m, in [0;36mwindow_adaptation.<locals>.run[0;34m(rng_key, position, num_steps)[0m
[1;32m    333[0m keys [38;5;241m=[39m jax[38;5;241m.[39mrandom[38;5;241m.[39msplit(rng_key, num_steps)
[1;32m    334[0m schedule [38;5;241m=[39m build_schedule(num_steps)
[0;32m--> 335[0m last_state, info [38;5;241m=[39m [43mjax[49m[38;5;241;43m.[39;49m[43mlax[49m[38;5;241;43m.[39;49m[43mscan[49m[43m([49m
[1;32m    336[0m [43m    [49m[43mone_step_[49m[43m,[49m
[1;32m    337[0m [43m    [49m[43m([49m[43minit_state[49m[43m,[49m[43m [49m[43minit_adaptation_state[49m[43m)[49m[43m,[49m
[1;32m    338[0m [43m    [49m[43m([49m[43mjnp[49m[38;5;241;43m.[39;49m[43marange[49m[43m([49m[43mnum_steps[49m[43m)[49m[43m,[49m[43m [49m[43mkeys[49m[43m,[49m[43m [49m[43mschedule[49m[43m)[49m[43m,[49m
[1;32m    339[0m [43m[49m[43m)[49m
[1;32m    340[0m last_chain_state, last_warmup_state, [38;5;241m*[39m_ [38;5;241m=[39m last_state
[1;32m    342[0m step_size, inverse_mass_matrix [38;5;241m=[39m adapt_final(last_warmup_state)

    [0;31m[... skipping hidden 21 frame][0m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/blackjax/progress_bar.py:97[0m, in [0;36mprogress_bar_scan.<locals>._progress_bar_scan.<locals>.wrapper_progress_bar[0;34m(carry, x)[0m
[1;32m     95[0m     iter_num [38;5;241m=[39m x
[1;32m     96[0m _update_progress_bar(iter_num)
[0;32m---> 97[0m result [38;5;241m=[39m [43mfunc[49m[43m([49m[43mcarry[49m[43m,[49m[43m [49m[43mx[49m[43m)[49m
[1;32m     98[0m [38;5;28;01mreturn[39;00m close_bar(result, iter_num)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/blackjax/adaptation/window_adaptation.py:303[0m, in [0;36mwindow_adaptation.<locals>.one_step[0;34m(carry, xs)[0m
[1;32m    300[0m _, rng_key, adaptation_stage [38;5;241m=[39m xs
[1;32m    301[0m state, adaptation_state [38;5;241m=[39m carry
[0;32m--> 303[0m new_state, info [38;5;241m=[39m [43mmcmc_kernel[49m[43m([49m
[1;32m    304[0m [43m    [49m[43mrng_key[49m[43m,[49m
[1;32m    305[0m [43m    [49m[43mstate[49m[43m,[49m
[1;32m    306[0m [43m    [49m[43mlogdensity_fn[49m[43m,[49m
[1;32m    307[0m [43m    [49m[43madaptation_state[49m[38;5;241;43m.[39;49m[43mstep_size[49m[43m,[49m
[1;32m    308[0m [43m    [49m[43madaptation_state[49m[38;5;241;43m.[39;49m[43minverse_mass_matrix[49m[43m,[49m
[1;32m    309[0m [43m    [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mextra_parameters[49m[43m,[49m
[1;32m    310[0m [43m[49m[43m)[49m
[1;32m    311[0m new_adaptation_state [38;5;241m=[39m adapt_step(
[1;32m    312[0m     adaptation_state,
[1;32m    313[0m     adaptation_stage,
[1;32m    314[0m     new_state[38;5;241m.[39mposition,
[1;32m    315[0m     info[38;5;241m.[39macceptance_rate,
[1;32m    316[0m )
[1;32m    318[0m [38;5;28;01mreturn[39;00m (
[1;32m    319[0m     (new_state, new_adaptation_state),
[1;32m    320[0m     AdaptationInfo(new_state, info, new_adaptation_state),
[1;32m    321[0m )

[0;31mTypeError[0m: kernel() got an unexpected keyword argument 'num_steps'

