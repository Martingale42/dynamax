Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------

posts = vmap(conditional_moments_gaussian_smoother, (None, None, 0))(params, EKFIntegrals, all_emissions)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn [12], line 1[0m
[0;32m----> 1[0m posts [38;5;241m=[39m [43mvmap[49m[43m([49m[43mconditional_moments_gaussian_smoother[49m[43m,[49m[43m [49m[43m([49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[38;5;241;43m0[39;49m[43m)[49m[43m)[49m[43m([49m[43mparams[49m[43m,[49m[43m [49m[43mEKFIntegrals[49m[43m,[49m[43m [49m[43mall_emissions[49m[43m)[49m

    [0;31m[... skipping hidden 3 frame][0m

File [0;32m/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/dynamax/generalized_gaussian_ssm/conditional_moments_gaussian_filter.py:322[0m, in [0;36mconditional_moments_gaussian_smoother[0;34m(model_params, inf_params, emissions, filtered_posterior, inputs)[0m
[1;32m    320[0m [38;5;66;03m# Get filtered posterior[39;00m
[1;32m    321[0m [38;5;28;01mif[39;00m filtered_posterior [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 322[0m     filtered_posterior [38;5;241m=[39m [43mconditional_moments_gaussian_filter[49m[43m([49m[43mmodel_params[49m[43m,[49m[43m [49m[43minf_params[49m[43m,[49m[43m [49m[43memissions[49m[43m,[49m[43m [49m[43minputs[49m[38;5;241;43m=[39;49m[43minputs[49m[43m)[49m
[1;32m    323[0m ll, filtered_means, filtered_covs, [38;5;241m*[39m_ [38;5;241m=[39m filtered_posterior
[1;32m    325[0m [38;5;66;03m# Process dynamics function to take in control inputs[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/dynamax/generalized_gaussian_ssm/conditional_moments_gaussian_filter.py:266[0m, in [0;36mconditional_moments_gaussian_filter[0;34m(model_params, inf_params, emissions, num_iter, inputs)[0m
[1;32m    264[0m [38;5;66;03m# Run the general linearization filter[39;00m
[1;32m    265[0m carry [38;5;241m=[39m ([38;5;241m0.0[39m, model_params[38;5;241m.[39minitial_mean, model_params[38;5;241m.[39minitial_covariance)
[0;32m--> 266[0m (ll, _, _), (filtered_means, filtered_covs) [38;5;241m=[39m [43mlax[49m[38;5;241;43m.[39;49m[43mscan[49m[43m([49m[43m_step[49m[43m,[49m[43m [49m[43mcarry[49m[43m,[49m[43m [49m[43mjnp[49m[38;5;241;43m.[39;49m[43marange[49m[43m([49m[43mnum_timesteps[49m[43m)[49m[43m)[49m
[1;32m    267[0m [38;5;28;01mreturn[39;00m PosteriorGGSSMFiltered(marginal_loglik[38;5;241m=[39mll, filtered_means[38;5;241m=[39mfiltered_means, filtered_covariances[38;5;241m=[39mfiltered_covs)

    [0;31m[... skipping hidden 9 frame][0m

File [0;32m/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/dynamax/generalized_gaussian_ssm/conditional_moments_gaussian_filter.py:256[0m, in [0;36mconditional_moments_gaussian_filter.<locals>._step[0;34m(carry, t)[0m
[1;32m    253[0m y [38;5;241m=[39m emissions[t]
[1;32m    255[0m [38;5;66;03m# Condition on the emission[39;00m
[0;32m--> 256[0m log_likelihood, filtered_mean, filtered_cov [38;5;241m=[39m [43m_condition_on[49m[43m([49m[43mpred_mean[49m[43m,[49m[43m [49m[43mpred_cov[49m[43m,[49m[43m [49m[43mm_Y[49m[43m,[49m[43m [49m[43mCov_Y[49m[43m,[49m[43m [49m[43mu[49m[43m,[49m[43m [49m[43my[49m[43m,[49m[43m [49m[43mg_ev[49m[43m,[49m[43m [49m[43mg_cov[49m[43m,[49m[43m [49m[43mnum_iter[49m[43m)[49m
[1;32m    257[0m ll [38;5;241m+[39m[38;5;241m=[39m log_likelihood
[1;32m    259[0m [38;5;66;03m# Predict the next state[39;00m

File [0;32m/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/dynamax/generalized_gaussian_ssm/conditional_moments_gaussian_filter.py:180[0m, in [0;36m_condition_on[0;34m(m, P, y_cond_mean, y_cond_cov, u, y, g_ev, g_cov, num_iter)[0m
[1;32m    178[0m [38;5;66;03m# Iterate re-linearization over posterior mean and covariance[39;00m
[1;32m    179[0m carry [38;5;241m=[39m (m, P)
[0;32m--> 180[0m (mu_cond, Sigma_cond), lls [38;5;241m=[39m [43mlax[49m[38;5;241;43m.[39;49m[43mscan[49m[43m([49m[43m_step[49m[43m,[49m[43m [49m[43mcarry[49m[43m,[49m[43m [49m[43mjnp[49m[38;5;241;43m.[39;49m[43marange[49m[43m([49m[43mnum_iter[49m[43m)[49m[43m)[49m
[1;32m    181[0m [38;5;28;01mreturn[39;00m lls[[38;5;241m0[39m], mu_cond, Sigma_cond

    [0;31m[... skipping hidden 9 frame][0m

File [0;32m/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/dynamax/generalized_gaussian_ssm/conditional_moments_gaussian_filter.py:169[0m, in [0;36m_condition_on.<locals>._step[0;34m(carry, _)[0m
[1;32m    167[0m [38;5;28;01mdef[39;00m [38;5;21m_step[39m(carry, _):
[1;32m    168[0m     prior_mean, prior_cov [38;5;241m=[39m carry
[0;32m--> 169[0m     yhat [38;5;241m=[39m [43mg_ev[49m[43m([49m[43mm_Y[49m[43m,[49m[43m [49m[43mprior_mean[49m[43m,[49m[43m [49m[43mprior_cov[49m[43m)[49m
[1;32m    170[0m     S [38;5;241m=[39m g_ev(Cov_Y, prior_mean, prior_cov) [38;5;241m+[39m g_cov(m_Y, m_Y, prior_mean, prior_cov)
[1;32m    171[0m     log_likelihood [38;5;241m=[39m MVN(yhat, S)[38;5;241m.[39mlog_prob(jnp[38;5;241m.[39matleast_1d(y))

[0;31mTypeError[0m: '_collections._tuplegetter' object is not callable
TypeError: '_collections._tuplegetter' object is not callable

