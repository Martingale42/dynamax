
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Welcome to DYNAMAX! &#8212; dynamax documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Casino HMM: Inference (state estimation)" href="notebooks/hmm/casino_hmm_inference.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="#">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.gif" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/casino_hmm_inference.html">
   Casino HMM: Inference (state estimation)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/casino_hmm_training.html">
   Casino HMM: learning (parameter estimation)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/gaussian_hmm_2d.html">
   Gaussian HMM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking.html">
   Tracking an object using the Kalman filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_linreg.html">
   Online linear regression using Kalman filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_learning.html">
   MAP parameter estimation for an LG-SSM using EM and SGD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_parallel_inference.html">
   Parallel filtering and smoothing in an LG-SSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_spiral.html">
   Tracking a spiraling object using the extended / unscented Kalman filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_pendulum.html">
   Tracking a 1d pendulum using Extended / Unscented Kalman filter/ smoother
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_mlp.html">
   Online learning for an MLP using extended Kalman filtering
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ssm.html">
   SSM
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/index.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Welcome to DYNAMAX!
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installation-and-testing">
     Installation and Testing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-are-state-space-models">
     What are state space models?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inference-state-estimation">
     Inference (state estimation)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-parameter-estimation">
     Learning (parameter estimation)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#related-libraries">
     Related Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebooks">
   Notebooks
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api-documentation">
   API documentation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indices-and-tables">
   Indices and tables
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Welcome to DYNAMAX!</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Welcome to DYNAMAX!
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installation-and-testing">
     Installation and Testing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-are-state-space-models">
     What are state space models?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inference-state-estimation">
     Inference (state estimation)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-parameter-estimation">
     Learning (parameter estimation)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#related-libraries">
     Related Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebooks">
   Notebooks
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api-documentation">
   API documentation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indices-and-tables">
   Indices and tables
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="welcome-to-dynamax">
<h1>Welcome to DYNAMAX!<a class="headerlink" href="#welcome-to-dynamax" title="Permalink to this headline">#</a></h1>
<p>Dynamax is a library for probabilistic state space models (SSMs) written in <a class="reference external" href="https://github.com/google/jax">JAX</a>.
It has code for inference (state estimation) and learning (parameter estimation)
in a variety of SSMs, including:</p>
<ul class="simple">
<li><p>Hidden Markov Models (HMMs)</p></li>
<li><p>Autoregressive Hidden Markov Models (AR-HMMs)</p></li>
<li><p>Linear Gaussian State Space Models (aka Linear Dynamical Systems)</p></li>
<li><p>Nonlinear Gaussian State Space Models</p></li>
</ul>
<p>The library consists of a set of core, functionally pure, low-level inference algorithms,
as well as a set of model classes which provide a more user-friendly, object-oriented interface.
It is compatible with other libraries in the JAX ecosystem,
such as <a class="reference external" href="https://github.com/deepmind/optax">optax</a> (useful for estimating parameters using stochastic gradient descent),
and <a class="reference external" href="https://github.com/blackjax-devs/blackjax">Blackjax</a> (useful for computing the posterior using Hamiltonian Monte Carlo (HMC)
or sequential Monte Carlo (SMC)).</p>
<section id="installation-and-testing">
<h2>Installation and Testing<a class="headerlink" href="#installation-and-testing" title="Permalink to this headline">#</a></h2>
<p>To install locally, do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone git@github.com:probml/dynamax.git</span>
<span class="go">cd dynamax</span>
<span class="go">pip install -e .</span>
</pre></div>
</div>
<p>To install in Colab, do this:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">%pip install git+https://github.com/probml/dynamax.git</span>
</pre></div>
</div>
<p>To run the tests, do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pytest dynamax                         # Run all tests</span>
<span class="go">pytest dynamax/hmm/inference_test.py   # Run a specific test</span>
<span class="go">pytest -k lgssm                        # Run tests with lgssm in the name</span>
</pre></div>
</div>
</section>
<section id="what-are-state-space-models">
<h2>What are state space models?<a class="headerlink" href="#what-are-state-space-models" title="Permalink to this headline">#</a></h2>
<p>A state space model or SSM is a partially observed Markov model, in which the hidden state,
<span class="math notranslate nohighlight">\(z_t\)</span>, evolves over time according to a Markov process,
possibly conditional on external inputs / controls / covariates,
<span class="math notranslate nohighlight">\(u_t\)</span>,
and generates an observation,
<span class="math notranslate nohighlight">\(y_t\)</span>.
This is illustrated in the graphical model below.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/LDS-UZY.png"><img alt="SSM as a graphical model." src="_images/LDS-UZY.png" style="width: 189.0px; height: 196.0px;" /></a>
</figure>
<p>The corresponding joint distribution has the following form
(in dynamax, we restrict attention to discrete time systems):</p>
<div class="math notranslate nohighlight">
\[p(y_{1:T}, z_{1:T} | u_{1:T}) = p(z_1 | u_1) p(y_1 | z_1, u_1) \prod_{t=1}^T p(z_t | z_{t-1}, u_t) p(y_t | z_t, u_t)\]</div>
<p>Here <span class="math notranslate nohighlight">\(p(z_t | z_{t-1}, u_t)\)</span> is called the transition or dynamics model,
and <span class="math notranslate nohighlight">\(p(y_t | z_{t}, u_t)\)</span> is called the observation or emission model.
(In both cases, the inputs <span class="math notranslate nohighlight">\(u_t\)</span> are optional;
furthermore, the observation model may have auto-regressive dependencies,
in which case we write  <span class="math notranslate nohighlight">\(p(y_t | z_{t}, u_t, y_{1:t-1})\)</span>.)</p>
<p>We assume that we see the observations <span class="math notranslate nohighlight">\(y_{1:T}\)</span>,
and want to infer the hidden states, either
using online filtering (i.e., computing  <span class="math notranslate nohighlight">\(p(z_t|y_{1:t})\)</span>)
or offline smoothing (i.e., computing  <span class="math notranslate nohighlight">\(p(z_t|y_{1:T})\)</span>).
We may also be interested in predicting future states,
<span class="math notranslate nohighlight">\(p(z_{t+h}|y_{1:t})\)</span>,
or future observations,
<span class="math notranslate nohighlight">\(p(y_{t+h}|y_{1:t})\)</span>,
where h is the forecast horizon.
(Note that by using a hidden state  to represent the past observations,
the model can have “infinite” memory, unlike a standard auto-regressive model.)
All of these computations can be done efficiently using our library,
as we discuss below.
In addition, we can estimate the parameters of the transition and emission models,
as we discuss below.</p>
<p>More information can be found in these books:
- <em>Machine Learning: Advanced Topics</em>, K. Murphy, MIT Press 2023.
Available at <a class="reference external" href="https://probml.github.io/pml-book/book2.html">https://probml.github.io/pml-book/book2.html</a>.
-  <em>Bayesian Filtering and Smoothing</em>, S. Särkkä, Cambridge University Press, 2013.
Available at <a class="reference external" href="https://users.aalto.fi/~ssarkka/pub/cup_book_online_20131111.pdf">https://users.aalto.fi/~ssarkka/pub/cup_book_online_20131111.pdf</a></p>
</section>
<section id="inference-state-estimation">
<h2>Inference (state estimation)<a class="headerlink" href="#inference-state-estimation" title="Permalink to this headline">#</a></h2>
<p>The core inference algorithms, like the forward-backward algorithm for HMMs,
the Kalman filter and smoother for LGSSMs, and the extended and unscented
Kalman filters for nonlinear SSMs, all have a simple, functional interface.
For example, the following code generates some noisy data and then smooths it
with an LGSSM smoother (aka Kalman smoother).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">grad</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax.random</span> <span class="k">as</span> <span class="nn">jr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dynamax.linear_gaussian_ssm.inference</span> <span class="kn">import</span> <span class="n">LGSSMParams</span><span class="p">,</span> <span class="n">lgssm_smoother</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">state_dim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">emission_dim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Make some noisy data</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_timesteps</span><span class="p">)</span>
<span class="n">emissions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">times</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">emissions</span> <span class="o">+=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">num_timesteps</span><span class="p">,</span> <span class="n">emission_dim</span><span class="p">))</span>

<span class="c1"># Specify the model parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">LGSSMParams</span><span class="p">(</span>
   <span class="n">initial_mean</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">initial_covariance</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">dynamics_matrix</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">dynamics_covariance</span><span class="o">=</span><span class="mf">0.5</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">emission_matrix</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">emission_dim</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">)),</span>
   <span class="n">emission_covariance</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">emission_dim</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Run the LGSSM smoother (aka Kalman smoother)</span>
<span class="n">lgssm_posterior</span> <span class="o">=</span> <span class="n">lgssm_smoother</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">emissions</span><span class="p">)</span>
</pre></div>
</div>
<p>The posterior is a dataclass with a number of fields, including the posterior mean and posterior marginal covariances.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lgssm_posterior</span><span class="o">.</span><span class="n">smoothed_means</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>        <span class="c1"># (100, 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lgssm_posterior</span><span class="o">.</span><span class="n">smoothed_covariances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (100, 1, 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lgssm_posterior</span><span class="o">.</span><span class="n">marginal_loglik</span><span class="p">)</span>             <span class="c1"># -160.31303</span>
</pre></div>
</div>
<p>The inference algorithms are all written in JAX, so they support automatic
differentiation and just-in-time compilation,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">params</span><span class="p">:</span> <span class="o">-</span><span class="n">lgssm_smoother</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">emissions</span><span class="p">)</span><span class="o">.</span><span class="n">marginal_loglik</span>
<span class="n">jit</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">))(</span><span class="n">params</span><span class="p">)</span> <span class="c1"># Returns an LGSSMParams dataclass with the gradients in it</span>
</pre></div>
</div>
</section>
<section id="learning-parameter-estimation">
<h2>Learning (parameter estimation)<a class="headerlink" href="#learning-parameter-estimation" title="Permalink to this headline">#</a></h2>
<p>Dynamax also includes a host of model classes for various HMMs and linear Gaussian SSMs.
You can use these models to simulate data, and you can fit the models using standard
learning algorithms like expectation-maximization (EM) and stochastic gradient descent (SGD).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax.random</span> <span class="k">as</span> <span class="nn">jr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dynamax.hmm.models</span> <span class="kn">import</span> <span class="n">GaussianHMM</span>

<span class="n">key1</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">key3</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">num_states</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">emission_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Make a Gaussian HMM and sample data from it</span>
<span class="n">true_hmm</span> <span class="o">=</span> <span class="n">GaussianHMM</span><span class="p">(</span><span class="n">num_states</span><span class="p">,</span> <span class="n">emission_dim</span><span class="p">)</span>
<span class="n">true_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">true_hmm</span><span class="o">.</span><span class="n">random_initialization</span><span class="p">(</span><span class="n">key1</span><span class="p">)</span>
<span class="n">true_states</span><span class="p">,</span> <span class="n">emissions</span> <span class="o">=</span> <span class="n">true_hmm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">true_params</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">num_timesteps</span><span class="p">)</span>

<span class="c1"># Make a new Gaussian HMM and fit it with EM</span>
<span class="n">test_hmm</span> <span class="o">=</span> <span class="n">GaussianHMM</span><span class="p">(</span><span class="n">num_states</span><span class="p">,</span> <span class="n">emission_dim</span><span class="p">)</span>
<span class="n">test_params</span><span class="p">,</span> <span class="n">props</span> <span class="o">=</span> <span class="n">test_hmm</span><span class="o">.</span><span class="n">random_initialization</span><span class="p">(</span><span class="n">key3</span><span class="p">)</span>
<span class="n">test_params</span><span class="p">,</span> <span class="n">lls</span> <span class="o">=</span> <span class="n">test_hmm</span><span class="o">.</span><span class="n">fit_em</span><span class="p">(</span><span class="n">test_params</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="n">emissions</span><span class="p">)</span>

<span class="c1"># Plot the marginal log probs across EM iterations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lls</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;EM iterations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;marginal log prob.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="related-libraries">
<h2>Related Libraries<a class="headerlink" href="#related-libraries" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/deepmind/distrax/blob/master/distrax/_src/utils/hmm.py">distrax_hmm</a>: JAX functions for HMM inference (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://github.com/rlabbe/Kalman-and-Bayesian-Filters-in-Python">filterpy</a>: Numpy library for (extended) Kalman filtering</p></li>
<li><p><a class="reference external" href="https://github.com/hmmlearn/hmmlearn">hmmlearn</a>: Numpy / C++ library for HMMs</p></li>
<li><p><a class="reference external" href="https://github.com/lindermanlab/ssm-jax">linderman-ssm-jax</a>:  JAX library for SSMs (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://github.com/lindermanlab/ssm">linderman-ssm-numpy</a>:  Numpy / numba / autograd library for SSMs  (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://github.com/mattjj/pyhsmm">mattjj-pyhsmm</a>:  Numpy / Cython library library for HMMs</p></li>
<li><p><a class="reference external" href="https://github.com/mattjj/pylds">mattjj-pylds</a>:  Numpy / Cython library library for linear dynamical systems</p></li>
<li><p><a class="reference external" href="https://github.com/probml/pgm-jax">pgm-jax</a>: JAX library for factor graphs</p></li>
<li><p><a class="reference external" href="https://github.com/probml/JSL">JSL</a>: JAX library for SSMs (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://pykalman.github.io/">pykalman</a>: Numpy library for (extended) Kalman filtering</p></li>
<li><p><a class="reference external" href="https://github.com/EEA-sensors/parallel-non-linear-gaussian-smoothers">sarkka-parallel-non-linear-gaussian-smoothers</a>: JAX code for nonlinear smoothers using parallel scan</p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/HiddenMarkovModel">tfp_hmm</a>: TF2 code for HMM inference</p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/LinearGaussianStateSpaceModel">tfp_lgssm</a>: TF2 code for Kalman filtering</p></li>
</ul>
</section>
</section>
<section id="notebooks">
<h1>Notebooks<a class="headerlink" href="#notebooks" title="Permalink to this headline">#</a></h1>
<div class="toctree-wrapper compound">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/casino_hmm_inference.html">Casino HMM: Inference (state estimation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/casino_hmm_training.html">Casino HMM: learning (parameter estimation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/gaussian_hmm_2d.html">Gaussian HMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking.html">Tracking an object using the Kalman filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_linreg.html">Online linear regression using Kalman filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_learning.html">MAP parameter estimation for an LG-SSM using EM and SGD</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_parallel_inference.html">Parallel filtering and smoothing in an LG-SSM</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_spiral.html">Tracking a spiraling object using the extended / unscented Kalman filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_pendulum.html">Tracking a 1d pendulum using Extended / Unscented Kalman filter/ smoother</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_mlp.html">Online learning for an MLP using extended Kalman filtering</a></li>
</ul>
</div>
</section>
<section id="api-documentation">
<h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">#</a></h1>
<div class="toctree-wrapper compound">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ssm.html">SSM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ssm.html#id1">SSM</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='right-next' id="next-link" href="notebooks/hmm/casino_hmm_inference.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Casino HMM: Inference (state estimation)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy<br/>
  
      &copy; Copyright 2022, Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>