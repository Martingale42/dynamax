
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>State Space Model (Base class)</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.gif" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  HMMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/casino_hmm_inference.html">
   Casino HMM: Inference (state estimation)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/casino_hmm_learning.html">
   Casino HMM: learning (parameter estimation)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/gaussian_hmm.html">
   Gaussian HMM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/autoregressive_hmm.html">
   Autoregressive (AR) HMM Demo
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Linear Gaussian SSMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking.html">
   Tracking an object using the Kalman filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_linreg.html">
   Online linear regression using Kalman filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_parallel_inference.html">
   Parallel filtering and smoothing in an LG-SSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_learning.html">
   MAP parameter estimation for an LG-SSM using EM and SGD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_hmc.html">
   Bayesian parameter estimation for an LG-SSM using HMC
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Nonlinear Gaussian SSMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_spiral.html">
   Tracking a spiraling object using the extended / unscented Kalman filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_pendulum.html">
   Tracking a 1d pendulum using Extended / Unscented Kalman filter/ smoother
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_mlp.html">
   Online learning for an MLP using extended Kalman filtering
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Generalized Gaussian SSMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_logistic_regression_demo.html">
   Online Logistic Regression using conditional moments Gaussian filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_mlp_classification_demo.html">
   Online learning of an MLP Classifier using conditional moments Gaussian filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html">
   Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   State Space Model (Base class)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#hidden-markov-model">
   Hidden Markov Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#linear-gaussian-ssm">
   Linear Gaussian SSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#nonlinear-gaussian-gssm">
   Nonlinear Gaussian GSSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#generalized-gaussian-gssm">
   Generalized Gaussian GSSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#utilities">
   Utilities
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/probml/dynamax"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   State Space Model (Base class)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamax.ssm.SSM">
     <code class="docutils literal notranslate">
      <span class="pre">
       SSM
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.initial_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.initial_distribution()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.transition_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.transition_distribution()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.emission_distribution()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prior">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.log_prior()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_shape">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.emission_shape
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.inputs_shape">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.inputs_shape
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.sample()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prob">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.log_prob()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.marginal_log_prob">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.marginal_log_prob()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.e_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.e_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.m_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.m_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_em">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.fit_em()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_sgd">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.fit_sgd()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parameters">
     Parameters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.parameters.ParameterSet">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParameterSet
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.parameters.PropertySet">
       <code class="docutils literal notranslate">
        <span class="pre">
         PropertySet
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.parameters.ParameterProperties">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParameterProperties
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hidden-markov-model">
   Hidden Markov Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#abstract-classes">
     Abstract classes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.log_prior">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.log_prior()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.marginal_log_prob">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.marginal_log_prob()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.filter">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.filter()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.smoother">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.smoother()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.e_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.e_step()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.initialize_m_step_state">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.initialize_m_step_state()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.m_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.m_step()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMInitialState
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState.distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMInitialState.distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMInitialState.initialize()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState.log_prior">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMInitialState.log_prior()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState.collect_suff_stats">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMInitialState.collect_suff_stats()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState.initialize_m_step_state">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMInitialState.initialize_m_step_state()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMInitialState.m_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMInitialState.m_step()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMTransitions
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions.distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMTransitions.distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMTransitions.initialize()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions.log_prior">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMTransitions.log_prior()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions.collect_suff_stats">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMTransitions.collect_suff_stats()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions.initialize_m_step_state">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMTransitions.initialize_m_step_state()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMTransitions.m_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMTransitions.m_step()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMEmissions
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.initialize()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.log_prior">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.log_prior()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.collect_suff_stats">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.collect_suff_stats()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.initialize_m_step_state">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.initialize_m_step_state()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMEmissions.m_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMMEmissions.m_step()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#high-level-models">
     High-level models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.BernoulliHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         BernoulliHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.BernoulliHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           BernoulliHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.CategoricalHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         CategoricalHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.CategoricalHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           CategoricalHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.GaussianHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         GaussianHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.GaussianHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           GaussianHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.DiagonalGaussianHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         DiagonalGaussianHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.DiagonalGaussianHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           DiagonalGaussianHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.SphericalGaussianHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         SphericalGaussianHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.SphericalGaussianHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           SphericalGaussianHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.SharedCovarianceGaussianHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         SharedCovarianceGaussianHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.SharedCovarianceGaussianHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           SharedCovarianceGaussianHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LowRankGaussianHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         LowRankGaussianHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LowRankGaussianHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           LowRankGaussianHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.MultinomialHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         MultinomialHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.MultinomialHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           MultinomialHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.PoissonHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         PoissonHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.PoissonHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           PoissonHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.GaussianMixtureHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         GaussianMixtureHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.GaussianMixtureHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           GaussianMixtureHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.DiagonalGaussianMixtureHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         DiagonalGaussianMixtureHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.DiagonalGaussianMixtureHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           DiagonalGaussianMixtureHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LinearRegressionHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         LinearRegressionHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LinearRegressionHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearRegressionHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LogisticRegressionHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         LogisticRegressionHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LogisticRegressionHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           LogisticRegressionHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.CategoricalRegressionHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         CategoricalRegressionHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.CategoricalRegressionHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           CategoricalRegressionHMM.initialize()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         LinearAutoregressiveHMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearAutoregressiveHMM.initialize()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM.sample">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearAutoregressiveHMM.sample()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM.compute_inputs">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearAutoregressiveHMM.compute_inputs()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#low-level-inference">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMPosterior">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMPosterior
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMPosteriorFiltered">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMPosteriorFiltered
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_two_filter_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_two_filter_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_fixed_lag_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_fixed_lag_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_posterior_mode">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_posterior_mode()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_posterior_sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_posterior_sample()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.parallel_hmm_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         parallel_hmm_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.parallel_hmm_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         parallel_hmm_smoother()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types">
     Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMParameterSet">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMParameterSet
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMMPropertySet">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMMPropertySet
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-gaussian-ssm">
   Linear Gaussian SSM
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#high-level-class">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         LinearGaussianSSM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.inputs_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.initialize()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.marginal_log_prob()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.filter()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.smoother()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.posterior_predictive()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.e_step()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.m_step()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         lgssm_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         lgssm_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         lgssm_posterior_sample()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSM
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSMInitial
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSMDynamics
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSMEmissions
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered">
       <code class="docutils literal notranslate">
        <span class="pre">
         PosteriorGSSMFiltered
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed">
       <code class="docutils literal notranslate">
        <span class="pre">
         PosteriorGSSMSmoothed
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nonlinear-gaussian-gssm">
   Nonlinear Gaussian GSSM
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         NonlinearGaussianSSM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.inputs_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         extended_kalman_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_extended_kalman_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         extended_kalman_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_extended_kalman_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         unscented_kalman_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         unscented_kalman_smoother()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsNLGSSM
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-gaussian-gssm">
   Generalized Gaussian GSSM
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         GeneralizedGaussianSSM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         conditional_moments_gaussian_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_conditional_moments_gaussian_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         conditional_moments_gaussian_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_conditional_moments_gaussian_smoother()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsGGSSM
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#utilities">
   Utilities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamax.utils.utils.find_permutation">
     <code class="docutils literal notranslate">
      <span class="pre">
       find_permutation()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="state-space-model-base-class">
<h1>State Space Model (Base class)<a class="headerlink" href="#state-space-model-base-class" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.ssm.SSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SSM</span></span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM" title="Permalink to this definition">¶</a></dt>
<dd><p>A base class for state space models. Such models consist of parameters, which
we may learn, as well as hyperparameters, which specify static properties of the
model. This base class allows parameters to be indicated a standardized way
so that they can easily be converted to/from unconstrained form for optimization.</p>
<p><strong>Abstract Methods</strong></p>
<p>Models that inherit from <cite>SSM</cite> must implement a few key functions and properties:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.initial_distribution" title="dynamax.ssm.SSM.initial_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initial_distribution()</span></code></a> returns the distribution over the initial state given parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.transition_distribution" title="dynamax.ssm.SSM.transition_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transition_distribution()</span></code></a> returns the conditional distribution over the next state given the current state and parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.emission_distribution" title="dynamax.ssm.SSM.emission_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">emission_distribution()</span></code></a> returns the conditional distribution over the emission given the current state and parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.log_prior" title="dynamax.ssm.SSM.log_prior"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_prior()</span></code></a> (optional) returns the log prior probability of the parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.emission_shape" title="dynamax.ssm.SSM.emission_shape"><code class="xref py py-attr docutils literal notranslate"><span class="pre">emission_shape</span></code></a> returns a tuple specification of the emission shape</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.inputs_shape" title="dynamax.ssm.SSM.inputs_shape"><code class="xref py py-attr docutils literal notranslate"><span class="pre">inputs_shape</span></code></a> returns a tuple specification of the input shape, or <cite>None</cite> if there are no inputs.</p></li>
</ul>
<p>The shape properties are required for properly handling batches of data.</p>
<p><strong>Sampling and Computing Log Probabilities</strong></p>
<p>Once these have been implemented, subclasses will inherit the ability to sample
and compute log joint probabilities from the base class functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.sample" title="dynamax.ssm.SSM.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> draws samples of the states and emissions for given parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.log_prob" title="dynamax.ssm.SSM.log_prob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_prob()</span></code></a> computes the log joint probability of the states and emissions for given parameters</p></li>
</ul>
<p><strong>Inference</strong></p>
<p>Many subclasses of SSMs expose basic functions for performing state inference.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.marginal_log_prob" title="dynamax.ssm.SSM.marginal_log_prob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">marginal_log_prob()</span></code></a> computes the marginal log probability of the emissions, summing over latent states</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.filter" title="dynamax.ssm.SSM.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a> computes the filtered posteriors</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.smoother" title="dynamax.ssm.SSM.smoother"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smoother()</span></code></a> computes the smoothed posteriors</p></li>
</ul>
<p><strong>Learning</strong></p>
<p>Likewise, many SSMs will support learning with expectation-maximization (EM) or stochastic gradient descent (SGD).</p>
<p>For expectation-maximization, subclasses must implement the E- and M-steps.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.e_step" title="dynamax.ssm.SSM.e_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">e_step()</span></code></a> computes the expected sufficient statistics for a sequence of emissions, given parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.m_step" title="dynamax.ssm.SSM.m_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">m_step()</span></code></a> finds new parameters that maximize the expected log joint probability</p></li>
</ul>
<p>Once these are implemented, the generic SSM class allows to fit the model with EM</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.fit_em" title="dynamax.ssm.SSM.fit_em"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_em()</span></code></a> run EM to find parameters that maximize the likelihood (or posterior) probability.</p></li>
</ul>
<p>For SGD, any subclass that implements <a class="reference internal" href="#dynamax.ssm.SSM.marginal_log_prob" title="dynamax.ssm.SSM.marginal_log_prob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">marginal_log_prob()</span></code></a> inherits the base class fitting function</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.fit_sgd" title="dynamax.ssm.SSM.fit_sgd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_sgd()</span></code></a> run SGD to minimize the <em>negative</em> marginal log probability.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.initial_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – optional  inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution over initial latent state, <span class="math notranslate nohighlight">\(p(x_1 \mid \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.transition_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state <span class="math notranslate nohighlight">\(p(x_{t+1} \mid x_t, u_t, \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.emission_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission <span class="math notranslate nohighlight">\(p(y_t \mid x_t, u_t, \theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.log_prior">
<span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log prior probability of any model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log prior probability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lp (Scalar)</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.emission_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamax.ssm.SSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s emissions.</p>
<p>For example, a <cite>GaussianHMM</cite> with <span class="math notranslate nohighlight">\(D\)</span> dimensional emissions would return <cite>(D,)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamax.ssm.SSM.inputs_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample states <span class="math notranslate nohighlight">\(x_{1:T}\)</span> and emissions <span class="math notranslate nohighlight">\(y_{1:T}\)</span> given parameters <span class="math notranslate nohighlight">\(\theta\)</span> and (optionally) inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Array</em><em>, </em><em>PRNGKeyArray</em><em>]</em>) – random number generator</p></li>
<li><p><strong>num_timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of timesteps <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>latent states and emissions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<em>Float</em>[Array, ‘num_timesteps state_dim’], <em>Float</em>[Array, ‘num_timesteps emission_dim’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log joint probability of the states and observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – </p></li>
<li><p><strong>states</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps state_dim'</em><em>]</em>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.marginal_log_prob">
<span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.marginal_log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log marginal likelihood of observations, <span class="math notranslate nohighlight">\(\log \sum_{z_{1:T}} p(y_{1:T}, z_{1:T} \mid \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>marginal log probability</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute filtering distributions, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t}, u_{1:t}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtering distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Posterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothing distribution, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:T}, u_{1:T}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothing distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Posterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.e_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an E-step to compute expected sufficient statistics under the posterior, <span class="math notranslate nohighlight">\(p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – emissions <span class="math notranslate nohighlight">\(y_{1:T}\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – optional inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected sufficient statistics under the posterior.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>PyTree</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.m_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an M-step to find parameters that maximize the expected log joint probability.</p>
<p>Specifically, compute</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \mathbb{E}_{p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)} \big[\log p(y_{1:T}, z_{1:T}, \theta \mid u_{1:T}) \big]\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>batch_stats</strong> (<em>PyTree</em>) – sufficient statistics from each sequence</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>) – any required state for optimizing the model parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.fit_em">
<span class="sig-name descname"><span class="pre">fit_em</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.fit_em"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.fit_em" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute parameter MLE/ MAP estimate using Expectation-Maximization (EM).</p>
<p>EM aims to find parameters that maximize the marginal log probability,</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \log p(y_{1:T}, \theta \mid u_{1:T})\]</div>
</p>
<p>It does so by iteratively forming a lower bound (the “E-step”) and then maximizing it (the “M-step”).</p>
<p><em>Note:</em> <code class="docutils literal notranslate"><span class="pre">emissions</span></code> <em>and</em> <code class="docutils literal notranslate"><span class="pre">inputs</span></code> <em>can either be single sequences or batches of sequences.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps emission_dim'</em><em>]</em><em>]</em>) – one or more sequences of emissions</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps input_dim'</em><em>]</em><em>]</em><em>]</em>) – one or more sequences of corresponding inputs</p></li>
<li><p><strong>num_iters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of iterations of EM to run</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – whether or not to show a progress bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of new parameters and log likelihoods over the course of EM iterations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <em>Float</em>[Array, ‘num_iters’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.fit_sgd">
<span class="sig-name descname"><span class="pre">fit_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">params,</span> <span class="pre">props,</span> <span class="pre">emissions,</span> <span class="pre">inputs=None,</span> <span class="pre">optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;,</span> <span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;),</span> <span class="pre">batch_size=1,</span> <span class="pre">num_epochs=50,</span> <span class="pre">shuffle=False,</span> <span class="pre">key=DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.fit_sgd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.fit_sgd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute parameter MLE/ MAP estimate using Stochastic Gradient Descent (SGD).</p>
<p>SGD aims to find parameters that maximize the marginal log probability,</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \log p(y_{1:T}, \theta \mid u_{1:T})\]</div>
</p>
<p>by minimizing the _negative_ of that quantity.</p>
<p><em>Note:</em> <code class="docutils literal notranslate"><span class="pre">emissions</span></code> <em>and</em> <code class="docutils literal notranslate"><span class="pre">inputs</span></code> <em>can either be single sequences or batches of sequences.</em></p>
<p>On each iteration, the algorithm grabs a <em>minibatch</em> of sequences and takes a gradient step.
One pass through the entire set of sequences is called an <em>epoch</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps emission_dim'</em><em>]</em><em>]</em>) – one or more sequences of emissions</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps input_dim'</em><em>]</em><em>]</em><em>]</em>) – one or more sequences of corresponding inputs</p></li>
<li><p><strong>optimizer</strong> (<em>GradientTransformation</em>) – an <cite>optax</cite> optimizer for minimization</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of sequences per minibatch</p></li>
<li><p><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of epochs of SGD to run</p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Array</em><em>, </em><em>PRNGKeyArray</em><em>]</em>) – a random number generator for selecting minibatches</p></li>
<li><p><strong>verbose</strong> – whether or not to show a progress bar</p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of new parameters and losses (negative scaled marginal log probs) over the course of SGD iterations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <em>Float</em>[Array, ‘niter’]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h2>
<p>Parameters and their associated properties are stored as <code class="xref py py-class docutils literal notranslate"><span class="pre">jax.DeviceArray</span></code>
and <a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamax.parameters.ParameterProperties</span></code></a>, respectively. They are bundled together into a
<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamax.parameters.ParameterSet</span></code></a> and a <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamax.parameters.PropertySet</span></code></a>, which are simply
aliases for immutable datastructures (in our case,  <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code>).</p>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.parameters.ParameterSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/parameters.html#ParameterSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.parameters.ParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code> with parameters stored as <code class="xref py py-class docutils literal notranslate"><span class="pre">jax.DeviceArray</span></code> in the leaf nodes.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.parameters.PropertySet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PropertySet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/parameters.html#PropertySet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.parameters.PropertySet" title="Permalink to this definition">¶</a></dt>
<dd><p>A matching <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code> with <a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterProperties</span></code></a> stored in the leaf nodes.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.parameters.ParameterProperties">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterProperties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrainer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/parameters.html#ParameterProperties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.parameters.ParameterProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>A PyTree containing parameter metadata (properties).</p>
<p>Note: the properties are stored in the aux_data of this PyTree so that
changes will trigger recompilation of functions that rely on them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – flag specifying whether or not to fit this parameter is adjustable.</p></li>
<li><p><strong>constrainer</strong> (<em>Optional tfb.Bijector</em>) – bijector mapping to constrained form.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="hidden-markov-model">
<h1>Hidden Markov Model<a class="headerlink" href="#hidden-markov-model" title="Permalink to this heading">¶</a></h1>
<section id="abstract-classes">
<h2>Abstract classes<a class="headerlink" href="#abstract-classes" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_component</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.ssm.SSM" title="dynamax.ssm.SSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSM</span></code></a></p>
<p>Abstract base class of Hidden Markov Models (HMMs).</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[z_1 \mid u_1 \sim \mathrm{Cat}(\pi_0(u_1, \theta_{\mathsf{init}}))\]</div>

<div class="math notranslate nohighlight">
\[z_t \mid z_{t-1}, u_t, \theta \sim \mathrm{Cat}(\pi(z_{t-1}, u_t, \theta_{\mathsf{trans}}))\]</div>

<div class="math notranslate nohighlight">
\[y_t | z_t, u_t, \theta \sim p(y_t \mid z_t, u_t, \theta_{\mathsf{emis}})\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(z_t \in \{1,\ldots,K\}\)</span> is a <em>discrete</em> latent state.
There are parameters for the initial distribution, the transition distribution,
and the emission distribution:</p>
<p><div class="math notranslate nohighlight">
\[\theta = (\theta_{\mathsf{init}}, \theta_{\mathsf{trans}}, \theta_{\mathsf{emis}})\]</div>
</p>
<p>For “standard” models, we will assume the initial distribution is fixed and the transitions
follow a simple transition matrix,</p>
<p><div class="math notranslate nohighlight">
\[z_1 \mid u_1 \sim \mathrm{Cat}(\pi_0)\]</div>

<div class="math notranslate nohighlight">
\[z_t \mid z_{t-1}=k \sim \mathrm{Cat}(\pi_{z_k})\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\theta_{\mathsf{init}} = \pi_0\)</span> and <span class="math notranslate nohighlight">\(\theta_{\mathsf{trans}} = \{\pi_k\}_{k=1}^K\)</span>.</p>
<p>The parameters are stored in a <a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.HMMParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMMParameterSet</span></code></a> object.</p>
<p>We have implemented many subclasses of <cite>HMM</cite> for various emission distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states</p></li>
<li><p><strong>initial_component</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMInitialState" title="dynamax.hidden_markov_model.models.abstractions.HMMInitialState"><em>HMMInitialState</em></a>) – object encapsulating the initial distribution</p></li>
<li><p><strong>transition_component</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMTransitions" title="dynamax.hidden_markov_model.models.abstractions.HMMTransitions"><em>HMMTransitions</em></a>) – object encapsulating the transition distribution</p></li>
<li><p><strong>emission_component</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMEmissions" title="dynamax.hidden_markov_model.models.abstractions.HMMEmissions"><em>HMMEmissions</em></a>) – object encapsulating the emission distribution</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s emissions.</p>
<p>For example, a <cite>GaussianHMM</cite> with <span class="math notranslate nohighlight">\(D\)</span> dimensional emissions would return <cite>(D,)</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>inputs</strong> – optional  inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution over initial latent state, <span class="math notranslate nohighlight">\(p(x_1 \mid \theta)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state <span class="math notranslate nohighlight">\(p(x_{t+1} \mid x_t, u_t, \theta)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission <span class="math notranslate nohighlight">\(p(y_t \mid x_t, u_t, \theta)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.log_prior">
<span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log prior probability of any model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log prior probability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lp (Scalar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.marginal_log_prob">
<span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.marginal_log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log marginal likelihood of observations, <span class="math notranslate nohighlight">\(\log \sum_{z_{1:T}} p(y_{1:T}, z_{1:T} \mid \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>marginal log probability</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute filtering distributions, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t}, u_{1:t}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtering distributions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothing distribution, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:T}, u_{1:T}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothing distributions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.e_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The E-step computes expected sufficient statistics under the
posterior. In the generic case, we simply return the posterior itself.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.initialize_m_step_state">
<span class="sig-name descname"><span class="pre">initialize_m_step_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.initialize_m_step_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.initialize_m_step_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize any required state for the M step.</p>
<p>For example, this might include the optimizer state for Adam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.m_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an M-step to find parameters that maximize the expected log joint probability.</p>
<p>Specifically, compute</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \mathbb{E}_{p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)} \big[\log p(y_{1:T}, z_{1:T}, \theta \mid u_{1:T}) \big]\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> – properties specifying which parameters should be learned</p></li>
<li><p><strong>batch_stats</strong> – sufficient statistics from each sequence</p></li>
<li><p><strong>m_step_state</strong> – any required state for optimizing the model parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new parameters</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMInitialState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract class for HMM initial distributions.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState.distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState.distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState.distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over the initial latent state</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>conditional distribution of initial state.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>PRNGKey</em><em>]</em>) – random number generator</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – specifies the type of initialization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of parameters and their corresponding properties</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState.log_prior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log prior probability of the initial distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – initial distribution parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState.collect_suff_stats">
<span class="sig-name descname"><span class="pre">collect_suff_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState.collect_suff_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState.collect_suff_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect sufficient statistics for updating the initial distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – initial distribution parameters</p></li>
<li><p><strong>posterior</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosterior" title="dynamax.hidden_markov_model.inference.HMMPosterior"><em>HMMPosterior</em></a>) – posterior distribution over latent states</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – optional inputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyTree of sufficient statistics for updating the initial distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>PyTree</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState.initialize_m_step_state">
<span class="sig-name descname"><span class="pre">initialize_m_step_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState.initialize_m_step_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState.initialize_m_step_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize any required state for the M step.</p>
<p>For example, this might include the optimizer state for Adam.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – </p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMInitialState.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMInitialState.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMInitialState.m_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an M-step on the initial distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – current initial distribution parameters</p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – parameter properties</p></li>
<li><p><strong>batch_stats</strong> (<em>PyTree</em>) – PyTree of sufficient statistics from each sequence, as output by <a class="reference internal" href="#dynamax.hidden_markov_model.HMMInitialState.collect_suff_stats" title="dynamax.hidden_markov_model.HMMInitialState.collect_suff_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">collect_suff_stats()</span></code></a>.</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>) – any state required for the M-step</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – how to scale the objective</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters that maximize the expected log joint probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMTransitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract class for HMM transitions.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions.distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions.distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions.distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over the next latent state</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – transition parameters</p></li>
<li><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – current latent state</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>PRNGKey</em><em>]</em>) – random number generator</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – specifies the type of initialization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of parameters and their corresponding properties</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions.log_prior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log prior probability of the transition distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – transition distribution parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions.collect_suff_stats">
<span class="sig-name descname"><span class="pre">collect_suff_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions.collect_suff_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions.collect_suff_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect sufficient statistics for updating the transition distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – transition distribution parameters</p></li>
<li><p><strong>posterior</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosterior" title="dynamax.hidden_markov_model.inference.HMMPosterior"><em>HMMPosterior</em></a>) – posterior distribution over latent states</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – optional inputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyTree of sufficient statistics for updating the transition distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>PyTree</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions.initialize_m_step_state">
<span class="sig-name descname"><span class="pre">initialize_m_step_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions.initialize_m_step_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions.initialize_m_step_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize any required state for the M step.</p>
<p>For example, this might include the optimizer state for Adam.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – </p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMTransitions.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMTransitions.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMTransitions.m_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an M-step on the transition distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – current transition distribution parameters</p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – parameter properties</p></li>
<li><p><strong>batch_stats</strong> (<em>PyTree</em>) – PyTree of sufficient statistics from each sequence, as output by <a class="reference internal" href="#dynamax.hidden_markov_model.HMMTransitions.collect_suff_stats" title="dynamax.hidden_markov_model.HMMTransitions.collect_suff_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">collect_suff_stats()</span></code></a>.</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>) – any state required for the M-step</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – how to scale the objective</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters that maximize the expected log joint probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMEmissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract class for HMM emissions.</p>
<dl class="field-list simple">
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.emission_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s emissions.</p>
<p>For example, a Gaussian HMM with D dimensional emissions would return (D,).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions.distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over the emission</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – emission parameters</p></li>
<li><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – current latent state</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of the emission</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>PRNGKey</em><em>]</em>) – random number generator</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – specifies the type of initialization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of parameters and their corresponding properties</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.log_prior">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log prior probability of the transition distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – transition distribution parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.collect_suff_stats">
<span class="sig-name descname"><span class="pre">collect_suff_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions.collect_suff_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.collect_suff_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect sufficient statistics for updating the emission distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – emission distribution parameters</p></li>
<li><p><strong>posterior</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosterior" title="dynamax.hidden_markov_model.inference.HMMPosterior"><em>HMMPosterior</em></a>) – posterior distribution over latent states</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – observed emissions</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – optional inputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>PyTree of sufficient statistics for updating the emission distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>PyTree</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.initialize_m_step_state">
<span class="sig-name descname"><span class="pre">initialize_m_step_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions.initialize_m_step_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.initialize_m_step_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize any required state for the M step.</p>
<p>For example, this might include the optimizer state for Adam.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – </p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMEmissions.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMEmissions.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMEmissions.m_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an M-step on the emission distribution parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – current emission distribution parameters</p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – parameter properties</p></li>
<li><p><strong>batch_stats</strong> (<em>PyTree</em>) – PyTree of sufficient statistics from each sequence, as output by <a class="reference internal" href="#dynamax.hidden_markov_model.HMMEmissions.collect_suff_stats" title="dynamax.hidden_markov_model.HMMEmissions.collect_suff_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">collect_suff_stats()</span></code></a>.</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>) – any state required for the M-step</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – how to scale the objective</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters that maximize the expected log joint probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="high-level-models">
<h2>High-level models<a class="headerlink" href="#high-level-models" title="Permalink to this heading">¶</a></h2>
<p>The HMM implementations below cover common emission distributions and,
if the emissions are exponential family distributions, the models implement
closed form EM updates. For HMMs with emissions outside the non-exponential family,
these models default to a generic M-step implemented in <code class="xref py py-class docutils literal notranslate"><span class="pre">HMMEmissions</span></code>.</p>
<p>Unless otherwise specified, these models have standard initial distributions and
transition distributions with conjugate, Bayesian priors on their parameters.</p>
<p><strong>Initial distribution:</strong></p>
<p><div class="math notranslate nohighlight">
\[p(z_1 \mid \pi_1) = \mathrm{Cat}(z_1 \mid \pi_1)\]</div>

<div class="math notranslate nohighlight">
\[p(\pi_1) = \mathrm{Dir}(\pi_1 \mid \alpha 1_K)\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the prior concentration on the initial distribution <span class="math notranslate nohighlight">\(\pi_1\)</span>.</p>
<p><strong>Transition distribution:</strong></p>
<p><div class="math notranslate nohighlight">
\[p(z_t \mid z_{t-1}, \theta) = \mathrm{Cat}(z_t \mid A_{z_{t-1}})\]</div>

<div class="math notranslate nohighlight">
\[p(A) = \prod_{k=1}^K \mathrm{Dir}(A_k \mid \beta 1_K)\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the prior concentration on the rows of the transition matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.BernoulliHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BernoulliHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/bernoulli_hmm.html#BernoulliHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.BernoulliHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with conditionally independent Bernoulli emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \{0,1\}^N\)</span> denote a binary vector of emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \prod_{n=1}^N \mathrm{Bern}(y_{tn} \mid \theta_{z_t,n})\]</div>

<div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \prod_{n=1}^N \mathrm{Beta}(\theta_{k,n}; \gamma_0, \gamma_1)\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\theta_{k,n} \in [0,1]\)</span> for <span class="math notranslate nohighlight">\(k=1,\ldots,K\)</span> and <span class="math notranslate nohighlight">\(n=1,\ldots,N\)</span> are the
<em>emission probabilities</em> and <span class="math notranslate nohighlight">\(\gamma_0, \gamma_1\)</span> are their prior pseudocounts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_concentration0</strong> – <span class="math notranslate nohighlight">\(\gamma_0\)</span></p></li>
<li><p><strong>emission_prior_concentration1</strong> – <span class="math notranslate nohighlight">\(\gamma_1\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.BernoulliHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/bernoulli_hmm.html#BernoulliHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.BernoulliHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<p>Note: in the future we may support more initialization schemes, like K-Means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters. Defaults to jr.PRNGKey(0).</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Currently, only “prior” is allowed. Defaults to “prior”.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities. Defaults to None.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix. Defaults to None.</p></li>
<li><p><strong>emission_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission probabilities. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.CategoricalHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CategoricalHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/categorical_hmm.html#CategoricalHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.CategoricalHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with conditionally independent categorical emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \{1,\ldots,C\}^N\)</span> denote a vector of <span class="math notranslate nohighlight">\(N\)</span> conditionally independent
categorical emissions from <span class="math notranslate nohighlight">\(C\)</span> classes at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,the emission
distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \prod_{n=1}^N \mathrm{Cat}(y_{tn} \mid \theta_{z_t,n})\]</div>

<div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \prod_{n=1}^N \mathrm{Dir}(\theta_{k,n}; \gamma 1_C)\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\theta_{k,n} \in \Delta_C\)</span> for <span class="math notranslate nohighlight">\(k=1,\ldots,K\)</span> and <span class="math notranslate nohighlight">\(n=1,\ldots,N\)</span> are the
<em>emission probabilities</em> and <span class="math notranslate nohighlight">\(\gamma\)</span> is their prior concentration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of multinomial classes <span class="math notranslate nohighlight">\(C\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> – <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.CategoricalHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/categorical_hmm.html#CategoricalHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.CategoricalHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<p>Note: in the future we may support more initialization schemes, like K-Means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em><em>, </em><em>optional</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters. Defaults to None.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>optional</em>) – method for initializing unspecified parameters. Currently, only “prior” is allowed. Defaults to “prior”.</p></li>
<li><p><strong>initial_probs</strong> (<em>array</em><em>, </em><em>optional</em>) – manually specified initial state probabilities. Defaults to None.</p></li>
<li><p><strong>transition_matrix</strong> (<em>array</em><em>, </em><em>optional</em>) – manually specified transition matrix. Defaults to None.</p></li>
<li><p><strong>emission_probs</strong> (<em>array</em><em>, </em><em>optional</em>) – manually specified emission probabilities. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.GaussianHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GaussianHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_extra_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#GaussianHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.GaussianHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with multivariate normal (i.e. Gaussian) emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \mathcal{N}(y_{t} \mid \mu_{z_t}, \Sigma_{z_t})\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\theta = \{\mu_k, \Sigma_k\}_{k=1}^K\)</span> denoting the <em>emission means</em> and <em>emission covariances</em>.</p>
<p>The model has a conjugate <a class="reference external" href="https://en.wikipedia.org/wiki/Normal-inverse-Wishart_distribution">normal-inverse-Wishart</a> prior,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \mathcal{N}(\mu_k \mid \mu_0, \kappa_0^{-1} \Sigma_k) \mathrm{IW}(\Sigma_{k} \mid \nu_0, \Psi_0)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_0\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\kappa_0\)</span></p></li>
<li><p><strong>emission_prior_extra_df</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\nu_0 - N &gt; 0\)</span>, the “extra” degrees of freedom, above and beyond the minimum of <span class="math notranslate nohighlight">\(\\nu_0 = N\)</span>.</p></li>
<li><p><strong>emission_prior_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\Psi_0\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.GaussianHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#GaussianHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.GaussianHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_covariances</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim emission_dim'</em><em>]</em><em>]</em>) – manually specified emission covariances.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.DiagonalGaussianHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiagonalGaussianHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#DiagonalGaussianHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.DiagonalGaussianHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with conditionally independent normal (i.e. Gaussian) emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \prod_{n=1}^N \mathcal{N}(y_{t,n} \mid \mu_{z_t,n}, \sigma_{z_t,n}^2)\]</div>

or equivalently
<div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \mathcal{N}(y_{t} \mid \mu_{z_t}, \mathrm{diag}(\sigma_{z_t}^2))\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\sigma_k^2 = [\sigma_{k,1}^2, \ldots, \sigma_{k,N}^2]\)</span> are the <em>emission variances</em> of each
dimension in state <span class="math notranslate nohighlight">\(z_t=k\)</span>. The complete set of parameters is <span class="math notranslate nohighlight">\(\theta = \{\mu_k, \sigma_k^2\}_{k=1}^K\)</span>.</p>
<p>The model has a conjugate <a class="reference external" href="https://en.wikipedia.org/wiki/Normal-inverse-gamma_distribution">normal-inverse-gamma</a> prior,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \prod_{n=1}^N \mathcal{N}(\mu_{k,n} \mid \mu_0, \kappa_0^{-1} \sigma_{k,n}^2) \mathrm{IGa}(\sigma_{k,n}^2 \mid \alpha_0, \beta_0)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_0\)</span></p></li>
<li><p><strong>emission_prior_mean_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\kappa_0\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha_0\)</span></p></li>
<li><p><strong>emission_prior_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\\beta_0\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.DiagonalGaussianHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_scale_diags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#DiagonalGaussianHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.DiagonalGaussianHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_scale_diags</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission standard deviations <span class="math notranslate nohighlight">\(\sigma_{k,n}\)</span></p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.SphericalGaussianHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SphericalGaussianHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean_covariance=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_var_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_var_rate=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#SphericalGaussianHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.SphericalGaussianHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with conditionally independent normal emissions with the same variance along
each dimension. These are called <em>spherical</em> Gaussian emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \prod_{n=1}^N \mathcal{N}(y_{t,n} \mid \mu_{z_t,n}, \sigma_{z_t}^2)\]</div>

or equivalently
<div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \mathcal{N}(y_{t} \mid \mu_{z_t}, \sigma_{z_t}^2 I)\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\sigma_k^2\)</span> is the <em>emission variance</em> in state <span class="math notranslate nohighlight">\(z_t=k\)</span>.
The complete set of parameters is <span class="math notranslate nohighlight">\(\theta = \{\mu_k, \sigma_k^2\}_{k=1}^K\)</span>.</p>
<p>The model has a non-conjugate, factored prior</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \mathcal{N}(\mu_{k} \mid \mu_0, \Sigma_0) \mathrm{Ga}(\sigma_{k}^2 \mid \alpha_0, \beta_0)\]</div>
</p>
<p><em>Note: In future versions we may implement a conjugate prior for this model.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_0\)</span></p></li>
<li><p><strong>emission_prior_mean_covariance</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\Sigma_0\)</span></p></li>
<li><p><strong>emission_var_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha_0\)</span></p></li>
<li><p><strong>emission_var_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta_0\)</span></p></li>
<li><p><strong>m_step_optimizer</strong> (<em>GradientTransformation</em>) – <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizer, like Adam.</p></li>
<li><p><strong>m_step_num_iters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of optimizer steps per M-step.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.SphericalGaussianHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#SphericalGaussianHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.SphericalGaussianHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_scales</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified emission scales (sqrt of diagonal of covariance matrix).</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.SharedCovarianceGaussianHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SharedCovarianceGaussianHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_extra_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#SharedCovarianceGaussianHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.SharedCovarianceGaussianHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with multivariate normal (i.e. Gaussian) emissions where the covariance
matrix is shared by all discrete states.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \mathcal{N}(y_{t} \mid \mu_{z_t}, \Sigma)\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\Sigma\)</span> is the <em>shared emission covariance</em>.</p>
<p>The complete set of parameters is <span class="math notranslate nohighlight">\(\theta = (\{\mu_k\}_{k=1}^K, \Sigma)\)</span>.</p>
<p>The model has a conjugate prior,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) = \mathrm{IW}(\Sigma \mid \nu_0, \Psi_0) \prod_{k=1}^K \mathcal{N}(\mu_{k} \mid \mu_0, \kappa_0^{-1} \Sigma)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_mean</strong> – <span class="math notranslate nohighlight">\(\mu_0\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> – <span class="math notranslate nohighlight">\(\kappa_0\)</span></p></li>
<li><p><strong>emission_prior_scale</strong> – <span class="math notranslate nohighlight">\(\Psi_0\)</span></p></li>
<li><p><strong>emission_prior_extra_df</strong> – <span class="math notranslate nohighlight">\(\nu_0 - N &gt; 0\)</span>, the “extra” degrees of freedom, above and beyond the minimum of <span class="math notranslate nohighlight">\(\\nu_0 = N\)</span>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.SharedCovarianceGaussianHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#SharedCovarianceGaussianHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.SharedCovarianceGaussianHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_covariance</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em>) – manually specified emission covariance.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LowRankGaussianHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LowRankGaussianHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_diag_factor_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_diag_factor_rate=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#LowRankGaussianHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LowRankGaussianHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with multivariate normal (i.e. Gaussian) emissions where the covariance
matrix is low rank plus diagonal.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \mathcal{N}(y_{t} \mid \mu_{z_t}, \Sigma_{z_t})\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\Sigma_k\)</span> factors as,</p>
<p><div class="math notranslate nohighlight">
\[\Sigma_k = U_k U_k^\top + \mathrm{diag}(d_k)\]</div>
</p>
<p>with <em>low rank factors</em> <span class="math notranslate nohighlight">\(U_k \in \mathbb{R}^{N \times M}\)</span> and
<em>diagonal factor</em> <span class="math notranslate nohighlight">\(d_k \in \mathbb{R}_+^{N}\)</span>.</p>
<p>The complete set of parameters is <span class="math notranslate nohighlight">\(\theta = (\{\mu_k, U_k, d_k\}_{k=1}^K\)</span>.</p>
<p>This model does not have a conjugate prior. Instead, we place a gamma prior on the diagonal factors,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) \propto \prod_{k=1}^K \prod_{n=1}^N \mathrm{Ga}(d_{k,n} \mid \alpha_0, \beta_0)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>emission_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – rank of the low rank factors, <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_diag_factor_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha_0\)</span></p></li>
<li><p><strong>emission_diag_factor_rate</strong> – <span class="math notranslate nohighlight">\(\beta_0\)</span></p></li>
<li><p><strong>m_step_optimizer</strong> – <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizer, like Adam.</p></li>
<li><p><strong>m_step_num_iters</strong> – number of optimizer steps per M-step.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LowRankGaussianHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_cov_diag_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_cov_low_rank_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gaussian_hmm.html#LowRankGaussianHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LowRankGaussianHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_cov_diag_factors</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission scales (sqrt of diagonal of covariance matrix).</p></li>
<li><p><strong>emission_cov_low_rank_factors</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim emission_rank'</em><em>]</em><em>]</em>) – manually specified emission low rank factors (sqrt of diagonal of covariance matrix).</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.MultinomialHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultinomialHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/multinomial_hmm.html#MultinomialHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.MultinomialHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with conditionally independent multinomial emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_{t,n} \in \mathbb{N}^C\)</span> denote a vector of <span class="math notranslate nohighlight">\(C\)</span> counts for each of <span class="math notranslate nohighlight">\(N\)</span>
conditionally independent multinomial emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,the emission
distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \prod_{n=1}^N \mathrm{Mult}(y_{tn} \mid R, \theta_{z_t,n})\]</div>

<div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \prod_{n=1}^N \mathrm{Dir}(\theta_{k,n}; \gamma 1_C)\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\theta_{k,n} \in \Delta_C\)</span> for <span class="math notranslate nohighlight">\(k=1,\ldots,K\)</span> and <span class="math notranslate nohighlight">\(n=1,\ldots,N\)</span> are the
<em>emission probabilities</em> and <span class="math notranslate nohighlight">\(\gamma\)</span> is their prior concentration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>num_classes</strong> – number of multinomial classes <span class="math notranslate nohighlight">\(C\)</span></p></li>
<li><p><strong>num_trials</strong> – number of multinomial trials <span class="math notranslate nohighlight">\(R\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> – <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.MultinomialHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/multinomial_hmm.html#MultinomialHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.MultinomialHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<p>Note: in the future we may support more initialization schemes, like K-Means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em><em>, </em><em>optional</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters. Defaults to None.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>optional</em>) – method for initializing unspecified parameters. Currently, only “prior” is allowed. Defaults to “prior”.</p></li>
<li><p><strong>initial_probs</strong> (<em>array</em><em>, </em><em>optional</em>) – manually specified initial state probabilities. Defaults to None.</p></li>
<li><p><strong>transition_matrix</strong> (<em>array</em><em>, </em><em>optional</em>) – manually specified transition matrix. Defaults to None.</p></li>
<li><p><strong>emission_probs</strong> (<em>array</em><em>, </em><em>optional</em>) – manually specified emission probabilities. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.PoissonHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PoissonHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/poisson_hmm.html#PoissonHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.PoissonHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with conditionally independent Poisson emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \{0,1\}^N\)</span> denote a vector of count emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \prod_{n=1}^N \mathrm{Po}(y_{tn} \mid \theta_{z_t,n})\]</div>

<div class="math notranslate nohighlight">
\[p(\theta) = \prod_{k=1}^K \prod_{n=1}^N \mathrm{Ga}(\theta_{k,n}; \gamma_0, \gamma_1)\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\theta_{k,n} \in \mathbb{R}_+\)</span> for <span class="math notranslate nohighlight">\(k=1,\ldots,K\)</span> and <span class="math notranslate nohighlight">\(n=1,\ldots,N\)</span> are the
<em>emission rates</em> and <span class="math notranslate nohighlight">\(\gamma_0, \gamma_1\)</span> are their prior concentration and rate, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> – <span class="math notranslate nohighlight">\(\gamma_0\)</span></p></li>
<li><p><strong>emission_prior_rate</strong> – <span class="math notranslate nohighlight">\(\gamma_1\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.PoissonHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_rates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/poisson_hmm.html#PoissonHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.PoissonHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<p>Note: in the future we may support more initialization schemes, like K-Means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters. Defaults to jr.PRNGKey(0).</p></li>
<li><p><strong>method</strong> – method for initializing unspecified parameters. Currently, only “prior” is allowed. Defaults to “prior”.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities. Defaults to None.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix. Defaults to None.</p></li>
<li><p><strong>emission_rates</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission probabilities. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.GaussianMixtureHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GaussianMixtureHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_extra_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gmm_hmm.html#GaussianMixtureHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.GaussianMixtureHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with mixture of multivariate normal (i.e. Gaussian) emissions.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \sum_{c=1}^C w_{k,c} \mathcal{N}(y_{t} \mid \mu_{z_t, c}, \Sigma_{z_t, c})\]</div>
</p>
<p>with <span class="math notranslate nohighlight">\(\theta = \{\{\mu_{k,c}, \Sigma_{k, c}\}_{c=1}^C, w_k \}_{k=1}^K\)</span> denoting
the <em>emission means</em>  and <em>emission covariances</em> for each disrete state <span class="math notranslate nohighlight">\(k\)</span> and <em>component</em> <span class="math notranslate nohighlight">\(c\)</span>,
as well as the <em>emission weights</em> <span class="math notranslate nohighlight">\(w_k \in \Delta_C\)</span>, which specify the probability of each
component in state <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The model has a conjugate <a class="reference external" href="https://en.wikipedia.org/wiki/Normal-inverse-Wishart_distribution">normal-inverse-Wishart</a> prior,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) = \mathrm{Dir}(w_k \mid \gamma 1_C) \prod_{k=1}^K \prod_{c=1}^C \mathcal{N}(\mu_{k,c} \mid \mu_0, \kappa_0^{-1} \Sigma_{k,c}) \mathrm{IW}(\Sigma_{k, c} \mid \nu_0, \Psi_0)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>num_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of mixture components <span class="math notranslate nohighlight">\(C\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_weights_concentration=</strong> – <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
<li><p><strong>emission_prior_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_0\)</span></p></li>
<li><p><strong>emission_prior_concentration</strong> – <span class="math notranslate nohighlight">\(\kappa_0\)</span></p></li>
<li><p><strong>emission_prior_extra_df</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\nu_0 - N &gt; 0\)</span>, the “extra” degrees of freedom, above and beyond the minimum of <span class="math notranslate nohighlight">\(\nu_0 = N\)</span>.</p></li>
<li><p><strong>emission_prior_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\Psi_0\)</span></p></li>
<li><p><strong>emission_weights_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_components'</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>emission_prior_mean_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.GaussianMixtureHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gmm_hmm.html#GaussianMixtureHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.GaussianMixtureHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_components'</em><em>]</em><em>]</em>) – manually specified emission weights.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_components emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_covariances</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_components emission_dim emission_dim'</em><em>]</em><em>]</em>) – manually specified emission covariances.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.DiagonalGaussianMixtureHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiagonalGaussianMixtureHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_mean_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_prior_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gmm_hmm.html#DiagonalGaussianMixtureHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.DiagonalGaussianMixtureHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM with mixture of multivariate normal (i.e. Gaussian) emissions with diagonal covariance.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote a vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>. In this model,
the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \sum_{c=1}^C w_{k,c} \mathcal{N}(y_{t} \mid \mu_{z_t, c}, \mathrm{diag}(\sigma_{z_t, c}^2))\]</div>
</p>
<p>or, equivalently,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, \theta) = \sum_{c=1}^C w_{k,c} \prod_{n=1}^N \mathcal{N}(y_{t,n} \mid \mu_{z_t, c, n}, \sigma_{z_t, c, n}^2)\]</div>
</p>
<p>The parameters are <span class="math notranslate nohighlight">\(\theta = \{\{\mu_{k,c}, \sigma_{k, c}^2\}_{c=1}^C, w_k \}_{k=1}^K\)</span> denoting
the <em>emission means</em>  and <em>emission variances</em> for each disrete state <span class="math notranslate nohighlight">\(k\)</span> and <em>component</em> <span class="math notranslate nohighlight">\(c\)</span>,
as well as the <em>emission weights</em> <span class="math notranslate nohighlight">\(w_k \in \Delta_C\)</span>, which specify the probability of each
component in state <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The model has a conjugate <a class="reference external" href="https://en.wikipedia.org/wiki/Normal-inverse-gamma_distribution">normal-inverse-gamma</a> prior,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) = \mathrm{Dir}(w_k \mid \gamma 1_C) \prod_{k=1}^K \prod_{c=1}^C \prod_{n=1}^N \mathcal{N}(\mu_{k,c,n} \mid \mu_0, \kappa_0^{-1} \sigma_{k,c}^2) \mathrm{IGa}(\sigma_{k, c, n}^2 \mid \alpha_0, \beta_0)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>num_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of mixture components <span class="math notranslate nohighlight">\(C\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of conditionally independent emissions <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_weights_concentration=</strong> – <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
<li><p><strong>emission_prior_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_0\)</span></p></li>
<li><p><strong>emission_prior_mean_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\kappa_0\)</span></p></li>
<li><p><strong>emission_prior_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha_0\)</span></p></li>
<li><p><strong>emission_prior_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta_0\)</span></p></li>
<li><p><strong>emission_weights_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_components'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.DiagonalGaussianMixtureHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_scale_diags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/gmm_hmm.html#DiagonalGaussianMixtureHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.DiagonalGaussianMixtureHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_components'</em><em>]</em><em>]</em>) – manually specified emission weights.</p></li>
<li><p><strong>emission_means</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_components emission_dim'</em><em>]</em><em>]</em>) – manually specified emission means.</p></li>
<li><p><strong>emission_scale_diags</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_components emission_dim'</em><em>]</em><em>]</em>) – manually specified emission scales (sqrt of the variances). Defaults to None.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LinearRegressionHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearRegressionHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/linreg_hmm.html#LinearRegressionHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LinearRegressionHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM whose emissions come from a linear regression with state-dependent weights.
This is also known as a <em>switching linear regression</em> model.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> and <span class="math notranslate nohighlight">\(u_t \in \mathbb{R}^M\)</span> denote vector-valued emissions
and inputs at time <span class="math notranslate nohighlight">\(t\)</span>, respectively. In this model, the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, u_t, \theta) = \mathcal{N}(y_{t} \mid W_{z_t} u_t + b_{z_t}, \Sigma_{z_t})\]</div>
</p>
<p>with <em>emission weights</em> <span class="math notranslate nohighlight">\(W_k \in \mathbb{R}^{N \times M}\)</span>, <em>emission biases</em> <span class="math notranslate nohighlight">\(b_k \in \mathbb{R}^N\)</span>,
and <em>emission covariances</em> <span class="math notranslate nohighlight">\(\Sigma_k \in \mathbb{R}_{\succeq 0}^{N \times N}\)</span>.</p>
<p>The emissions parameters are <span class="math notranslate nohighlight">\(\theta = \{W_k, b_k, \Sigma_k\}_{k=1}^K\)</span>.</p>
<p>We do not place a prior on the emission parameters.</p>
<p><em>Note: in the future we add a</em> <a class="reference external" href="https://github.com/probml/pml2-book">matrix-normal-inverse-Wishart</a> <em>prior (see pg 576).</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – input dimension <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – emission dimension <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LinearRegressionHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/linreg_hmm.html#LinearRegressionHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LinearRegressionHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim input_dim'</em><em>]</em><em>]</em>) – manually specified emission weights.</p></li>
<li><p><strong>emission_biases</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission biases.</p></li>
<li><p><strong>emission_covariances</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim emission_dim'</em><em>]</em><em>]</em>) – manually specified emission covariances.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LogisticRegressionHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LogisticRegressionHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_matrices_scale=100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/logreg_hmm.html#LogisticRegressionHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LogisticRegressionHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM whose emissions come from a logistic regression with state-dependent weights.
This is also known as a <em>switching logistic regression</em> model.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \{0,1\}\)</span> and <span class="math notranslate nohighlight">\(u_t \in \mathbb{R}^M\)</span> denote binary emissions
and inputs at time <span class="math notranslate nohighlight">\(t\)</span>, respectively. In this model, the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, u_t, \theta) = \mathrm{Bern}(y_{t} \mid \sigma(w_{z_t}^\top u_t + b_{z_t}))\]</div>
</p>
<p>with <em>emission weights</em> <span class="math notranslate nohighlight">\(w_k \in \mathbb{R}^{M}\)</span> and <em>emission biases</em> <span class="math notranslate nohighlight">\(b_k \in \mathbb{R}\)</span>.</p>
<p>We use <span class="math notranslate nohighlight">\(L_2\)</span> regularization on the emission weights, which can be thought of as a
Gaussian prior,</p>
<p><div class="math notranslate nohighlight">
\[p(\theta) \propto \prod_{k=1}^K \prod_{m=1}^M \mathcal{N}(w_{k,m} \mid 0, \varsigma^2)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – input dimension <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>emission_matrices_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\varsigma\)</span></p></li>
<li><p><strong>m_step_optimizer</strong> (<em>GradientTransformation</em>) – <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizer, like Adam.</p></li>
<li><p><strong>m_step_num_iters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of optimizer steps per M-step.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LogisticRegressionHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/logreg_hmm.html#LogisticRegressionHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LogisticRegressionHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states input_dim'</em><em>]</em><em>]</em>) – manually specified emission weights.</p></li>
<li><p><strong>emission_biases</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified emission biases.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>]</em><em>]</em>) – inputs for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.CategoricalRegressionHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CategoricalRegressionHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration=1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_num_iters=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/categorical_glm_hmm.html#CategoricalRegressionHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.CategoricalRegressionHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An HMM whose emissions come from a categorical regression with state-dependent weights.
This is also known as a <em>switching multiclass logistic regression</em> model.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \{1, \ldots, C\}\)</span> and <span class="math notranslate nohighlight">\(u_t \in \mathbb{R}^M\)</span> denote categorical emissions
and inputs at time <span class="math notranslate nohighlight">\(t\)</span>, respectively. In this model, the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, u_t, \theta) = \mathrm{Cat}(y_{t} \mid \mathrm{softmax}(W_{z_t} u_t + b_{z_t}))\]</div>
</p>
<p>with <em>emission weights</em> <span class="math notranslate nohighlight">\(W_k \in \mathbb{R}^{C \times M}\)</span> and <em>emission biases</em> <span class="math notranslate nohighlight">\(b_k \in \mathbb{R}^C\)</span>.</p>
<p>This model does not have a prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of emission classes <span class="math notranslate nohighlight">\(C\)</span></p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – input dimension <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
<li><p><strong>m_step_optimizer</strong> (<em>GradientTransformation</em>) – <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizer, like Adam.</p></li>
<li><p><strong>m_step_num_iters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of optimizer steps per M-step.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.CategoricalRegressionHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/categorical_glm_hmm.html#CategoricalRegressionHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.CategoricalRegressionHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_classes input_dim'</em><em>]</em><em>]</em>) – manually specified emission weights.</p></li>
<li><p><strong>emission_biases</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_classes'</em><em>]</em><em>]</em>) – manually specified emission biases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LinearAutoregressiveHMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearAutoregressiveHMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_lags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/arhmm.html#LinearAutoregressiveHMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamax.hidden_markov_model.HMM" title="dynamax.hidden_markov_model.models.abstractions.HMM"><code class="xref py py-class docutils literal notranslate"><span class="pre">HMM</span></code></a></p>
<p>An autoregressive HMM whose emissions are a linear function of the previous emissions with state-dependent weights.
This is also known as a <em>switching vector autoregressive</em> model.</p>
<p>Let <span class="math notranslate nohighlight">\(y_t \in \mathbb{R}^N\)</span> denote vector-valued emissions at time <span class="math notranslate nohighlight">\(t\)</span>.
In this model, the emission distribution is,</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid y_{1:t-1}, z_t, \theta) = \mathcal{N}(y_{t} \mid \sum_{\ell = 1}^L W_{z_t, \ell} y_{t-\ell} + b_{z_t}, \Sigma_{z_t})\]</div>
</p>
<p>with <em>emission weights</em> <span class="math notranslate nohighlight">\(W_{k,\ell} \in \mathbb{R}^{N \times N}\)</span> for each <em>lag</em> <span class="math notranslate nohighlight">\(\ell=1,\ldots,L\)</span>,
<em>emission biases</em> <span class="math notranslate nohighlight">\(b_k \in \mathbb{R}^N\)</span>,
and <em>emission covariances</em> <span class="math notranslate nohighlight">\(\Sigma_k \in \mathbb{R}_{\succeq 0}^{N \times N}\)</span>.</p>
<p>The emissions parameters are <span class="math notranslate nohighlight">\(\theta = \{\{W_{k,\ell}\}_{\ell=1}^L, b_k, \Sigma_k\}_{k=1}^K\)</span>.</p>
<p>We do not place a prior on the emission parameters.</p>
<p><em>Note: in the future we add a</em> <a class="reference external" href="https://github.com/probml/pml2-book">matrix-normal-inverse-Wishart</a> <em>prior (see pg 576).</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of discrete states <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – emission dimension <span class="math notranslate nohighlight">\(N\)</span></p></li>
<li><p><strong>num_lags</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of lags <span class="math notranslate nohighlight">\(L\)</span></p></li>
<li><p><strong>initial_probs_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\alpha\)</span></p></li>
<li><p><strong>transition_matrix_concentration</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LinearAutoregressiveHMM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/arhmm.html#LinearAutoregressiveHMM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<p>You can either specify parameters manually via the keyword arguments, or you can have
them set automatically. If any parameters are not specified, you must supply a PRNGKey.
Parameters will then be sampled from the prior (if <cite>method==prior</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator for unspecified parameters. Must not be None if there are any unspecified parameters.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method for initializing unspecified parameters. Both “prior” and “kmeans” are supported.</p></li>
<li><p><strong>initial_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em><em>]</em>) – manually specified initial state probabilities.</p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – manually specified transition matrix.</p></li>
<li><p><strong>emission_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim emission_dim_times_num_lags'</em><em>]</em><em>]</em>) – manually specified emission weights. The weights are stored as matrices <span class="math notranslate nohighlight">\(W_k = [W_{k,1}, \ldots, W_{k,L}] \in \mathbb{R}^{N \times N \cdot L}\)</span>.</p></li>
<li><p><strong>emission_biases</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim'</em><em>]</em><em>]</em>) – manually specified emission biases.</p></li>
<li><p><strong>emission_covariances</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states emission_dim emission_dim'</em><em>]</em><em>]</em>) – manually specified emission covariances.</p></li>
<li><p><strong>emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em><em>]</em>) – emissions for initializing the parameters with kmeans.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>, <a class="reference internal" href="#dynamax.hidden_markov_model.HMMPropertySet" title="dynamax.hidden_markov_model.models.abstractions.HMMPropertySet"><em>HMMPropertySet</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LinearAutoregressiveHMM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/arhmm.html#LinearAutoregressiveHMM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample states <span class="math notranslate nohighlight">\(z_{1:T}\)</span> and emissions <span class="math notranslate nohighlight">\(y_{1:T}\)</span> given parameters <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.hidden_markov_model.HMMParameterSet" title="dynamax.hidden_markov_model.models.abstractions.HMMParameterSet"><em>HMMParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>key</strong> (<em>PRNGKey</em>) – random number generator</p></li>
<li><p><strong>num_timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of timesteps <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p><strong>prev_emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_lags emission_dim'</em><em>]</em><em>]</em>) – (optionally) preceding emissions <span class="math notranslate nohighlight">\(y_{-L+1:0}\)</span>. Defaults to zeros.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>latent states and emissions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<em>Float</em>[Array, ‘num_timesteps state_dim’], <em>Float</em>[Array, ‘num_timesteps emission_dim’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.LinearAutoregressiveHMM.compute_inputs">
<span class="sig-name descname"><span class="pre">compute_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_emissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/arhmm.html#LinearAutoregressiveHMM.compute_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.LinearAutoregressiveHMM.compute_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to compute the matrix of lagged emissions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\((T \times N)\)</span> array of emissions</p></li>
<li><p><strong>prev_emissions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_lags emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\((L \times N)\)</span> array of previous emissions. Defaults to zeros.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\((T \times N \cdot L)\)</span> array of lagged emissions. These are the inputs to the fitting functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Float</em>[Array, ‘num_timesteps emission_dim_times_num_lags’]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="low-level-inference">
<h2>Low-level inference<a class="headerlink" href="#low-level-inference" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#HMMPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper for properties of an HMM posterior distribution.</p>
<p>Transition probabilities may be either 2D or 3D depending on whether the
transition matrix is fixed or time-varying.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(p(y_{1:T} \mid \theta) = \log \sum_{z_{1:T}} p(y_{1:T}, z_{1:T} \mid \theta)\)</span>.</p></li>
<li><p><strong>filtered_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span></p></li>
<li><p><strong>predicted_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t-1}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span></p></li>
<li><p><strong>smoothed_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:T}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span></p></li>
<li><p><strong>initial_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid y_{1:T}, \theta)\)</span> (also present in <cite>smoothed_probs</cite> but here for convenience)</p></li>
<li><p><strong>trans_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_t, z_{t+1} \mid y_{1:T}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T-1\)</span>. (If the transition matrix is fixed, these probabilities may be summed over <span class="math notranslate nohighlight">\(t\)</span>. See note above.)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMPosteriorFiltered">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMPosteriorFiltered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#HMMPosteriorFiltered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMPosteriorFiltered" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper for properties of an HMM filtering posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(p(y_{1:T} \mid \theta) = \log \sum_{z_{1:T}} p(y_{1:T}, z_{1:T} \mid \theta)\)</span>.</p></li>
<li><p><strong>filtered_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span></p></li>
<li><p><strong>predicted_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t-1}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_filter">
<span class="sig-name descname"><span class="pre">hmm_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards filtering</p>
<p>Transition matrix may be either 2D (if transition probabilities are fixed) or 3D
if the transition probabilities vary over time. Alternatively, the transition
matrix may be specified via <cite>transition_fn</cite>, which takes in a time index <span class="math notranslate nohighlight">\(t\)</span> and
returns a transition matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – function that takes in an integer time index and returns a <span class="math notranslate nohighlight">\(K \times K\)</span> transition matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered posterior distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosteriorFiltered" title="dynamax.hidden_markov_model.inference.HMMPosteriorFiltered"><em>HMMPosteriorFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_smoother">
<span class="sig-name descname"><span class="pre">hmm_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_trans_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Computed the smoothed state probabilities using a general
Bayesian smoother.</p>
<p>Transition matrix may be either 2D (if transition probabilities are fixed) or 3D
if the transition probabilities vary over time. Alternatively, the transition
matrix may be specified via <cite>transition_fn</cite>, which takes in a time index <span class="math notranslate nohighlight">\(t\)</span> and
returns a transition matrix.</p>
<p><em>Note: This is the discrete SSM analog of the RTS smoother for linear Gaussian SSMs.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – function that takes in an integer time index and returns a <span class="math notranslate nohighlight">\(K \times K\)</span> transition matrix.</p></li>
<li><p><strong>compute_trans_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosterior" title="dynamax.hidden_markov_model.inference.HMMPosterior"><em>HMMPosterior</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_two_filter_smoother">
<span class="sig-name descname"><span class="pre">hmm_two_filter_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_trans_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_two_filter_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_two_filter_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Computed the smoothed state probabilities using the two-filter
smoother, a.k.a. the <strong>forward-backward algorithm</strong>.</p>
<p>Transition matrix may be either 2D (if transition probabilities are fixed) or 3D
if the transition probabilities vary over time. Alternatively, the transition
matrix may be specified via <cite>transition_fn</cite>, which takes in a time index <span class="math notranslate nohighlight">\(t\)</span> and
returns a transition matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – function that takes in an integer time index and returns a <span class="math notranslate nohighlight">\(K \times K\)</span> transition matrix.</p></li>
<li><p><strong>compute_trans_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosterior" title="dynamax.hidden_markov_model.inference.HMMPosterior"><em>HMMPosterior</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_fixed_lag_smoother">
<span class="sig-name descname"><span class="pre">hmm_fixed_lag_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_fixed_lag_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_fixed_lag_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the smoothed state probabilities using the fixed-lag smoother.</p>
<p>The smoothed probability estimates</p>
<p><div class="math notranslate nohighlight">
\[p(z_t \mid y_{1:t+L}, u_{1:t+L}, \theta)\]</div>
</p>
<p>Transition matrix may be either 2D (if transition probabilities are fixed) or 3D
if the transition probabilities vary over time. Alternatively, the transition
matrix may be specified via <cite>transition_fn</cite>, which takes in a time index <span class="math notranslate nohighlight">\(t\)</span> and
returns a transition matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>window_size</strong> (<em>Int</em>) – the number of future steps to use, <span class="math notranslate nohighlight">\(L\)</span></p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – function that takes in an integer time index and returns a <span class="math notranslate nohighlight">\(K \times K\)</span> transition matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosterior" title="dynamax.hidden_markov_model.inference.HMMPosterior"><em>HMMPosterior</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_posterior_mode">
<span class="sig-name descname"><span class="pre">hmm_posterior_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_posterior_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_posterior_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the most likely state sequence. This is called the Viterbi algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – function that takes in an integer time index and returns a <span class="math notranslate nohighlight">\(K \times K\)</span> transition matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>most likely state sequence</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Int</em>[Array, ‘num_timesteps’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_posterior_sample">
<span class="sig-name descname"><span class="pre">hmm_posterior_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_posterior_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_posterior_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a latent sequence from the posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>PRNGKey</em>) – random number generator</p></li>
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – function that takes in an integer time index and returns a <span class="math notranslate nohighlight">\(K \times K\)</span> transition matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sample of the latent states, <span class="math notranslate nohighlight">\(z_{1:T}\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Int</em>[Array, ‘num_timesteps’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.parallel_hmm_filter">
<span class="sig-name descname"><span class="pre">parallel_hmm_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamax.hidden_markov_model.parallel_hmm_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallel implementation of the forward filtering algorithm with <cite>jax.lax.associative_scan</cite>.</p>
<p><em>Note: for this function, the transition matrix must be fixed. We may add support
for nonstationary transition matrices in a future release.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>initial_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered posterior distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosteriorFiltered" title="dynamax.hidden_markov_model.inference.HMMPosteriorFiltered"><em>HMMPosteriorFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.parallel_hmm_smoother">
<span class="sig-name descname"><span class="pre">parallel_hmm_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamax.hidden_markov_model.parallel_hmm_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallel implementation of HMM smoothing with <cite>jax.lax.associative_scan</cite>.</p>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>This implementation uses the automatic differentiation of the HMM log normalizer rather than an explicit implementation of the backward message passing.</p></li>
<li><p>The transition matrix must be fixed. We may add support for nonstationary transition matrices in a future release.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> – <span class="math notranslate nohighlight">\(p(z_1 \mid u_1, \theta)\)</span></p></li>
<li><p><strong>transition_matrix</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span></p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots, T\)</span>.</p></li>
<li><p><strong>initial_probs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothed posterior distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.hidden_markov_model.HMMPosteriorFiltered" title="dynamax.hidden_markov_model.inference.HMMPosteriorFiltered"><em>HMMPosteriorFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="types">
<h2>Types<a class="headerlink" href="#types" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMParameterSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMParameterSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMParameterSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for HMM parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> – (ParameterSet) initial distribution parameters</p></li>
<li><p><strong>transitions</strong> – (ParameterSet) transition distribution parameters</p></li>
<li><p><strong>emissions</strong> – (ParameterSet) emission distribution parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMMPropertySet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMMPropertySet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMMPropertySet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMMPropertySet" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for properties of HMM parameter properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> – (PropertySet) initial distribution properties</p></li>
<li><p><strong>transitions</strong> – (PropertySet) transition distribution properties</p></li>
<li><p><strong>emissions</strong> – (PropertySet) emission distribution properties</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="linear-gaussian-ssm">
<h1>Linear Gaussian SSM<a class="headerlink" href="#linear-gaussian-ssm" title="Permalink to this heading">¶</a></h1>
<section id="high-level-class">
<h2>High-level class<a class="headerlink" href="#high-level-class" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_dynamics_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_emissions_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(x_1) = \mathcal{N}(x_1 \mid m, S)\]</div>

<div class="math notranslate nohighlight">
\[p(x_t \mid x_{t-1}, u_t) = \mathcal{N}(x_t \mid F_t x_{t-1} + B_t u_t + b_t, Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t \mid x_t) = \mathcal{N}(y_t \mid H_t x_t + D_t u_t + d_t, R_t)\]</div>
</p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_t\)</span> is a latent state of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> is an emission of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> is an input of size <cite>input_dim</cite> (defaults to 0)</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span> = dynamics (transition) matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span> = optional input-to-state weight matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> = optional input-to-state bias vector</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = covariance matrix of dynamics (system) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span> = emission (observation) matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = optional input-to-emission weight matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> = optional input-to-emission bias vector</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> = covariance function for emission (observation) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = mean of initial state</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = covariance matrix of initial state</p></li>
</ul>
<p>The parameters of the model are stored in a <a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamsLGSSM</span></code></a>.
You can create the parameters manually, or by calling <a class="reference internal" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize" title="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Dimensionality of latent state.</p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Dimensionality of observation vector.</p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Dimensionality of input vector. Defaults to 0.</p></li>
<li><p><strong>has_dynamics_bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Whether model contains an offset term <span class="math notranslate nohighlight">\(b\)</span>. Defaults to True.</p></li>
<li><p><strong>has_emissions_bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Whether model contains an offset term <span class="math notranslate nohighlight">\(d\)</span>. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s emissions.</p>
<p>For example, a <cite>GaussianHMM</cite> with <span class="math notranslate nohighlight">\(D\)</span> dimensional emissions would return <cite>(D,)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_input_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_input_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize model parameters that are set to None, and their corresponding properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Array</em><em>, </em><em>PRNGKeyArray</em><em>]</em>) – Random number key. Defaults to jr.PRNGKey(0).</p></li>
<li><p><strong>initial_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em>) – parameter <span class="math notranslate nohighlight">\(m\)</span>. Defaults to None.</p></li>
<li><p><strong>initial_covariance</strong> – parameter <span class="math notranslate nohighlight">\(S\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_weights</strong> – parameter <span class="math notranslate nohighlight">\(F\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_bias</strong> – parameter <span class="math notranslate nohighlight">\(b\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_input_weights</strong> – parameter <span class="math notranslate nohighlight">\(B\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_covariance</strong> – parameter <span class="math notranslate nohighlight">\(Q\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_weights</strong> – parameter <span class="math notranslate nohighlight">\(H\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_bias</strong> – parameter <span class="math notranslate nohighlight">\(d\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_input_weights</strong> – parameter <span class="math notranslate nohighlight">\(D\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_covariance</strong> – parameter <span class="math notranslate nohighlight">\(R\)</span>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM">ParamsLGSSM</a>, <a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM">ParamsLGSSM</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional  inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution over initial latent state, <span class="math notranslate nohighlight">\(p(x_1 \mid \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state <span class="math notranslate nohighlight">\(p(x_{t+1} \mid x_t, u_t, \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission <span class="math notranslate nohighlight">\(p(y_t \mid x_t, u_t, \theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob">
<span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log marginal likelihood of observations, <span class="math notranslate nohighlight">\(\log \sum_{z_{1:T}} p(y_{1:T}, z_{1:T} \mid \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>marginal log probability</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>, <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute filtering distributions, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t}, u_{1:t}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtering distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMFiltered"><em>PosteriorGSSMFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothing distribution, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:T}, u_{1:T}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothing distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMSmoothed"><em>PosteriorGSSMSmoothed</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive">
<span class="sig-name descname"><span class="pre">posterior_predictive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.posterior_predictive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute marginal posterior predictive smoothing distribution for each observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior predictive means <span class="math notranslate nohighlight">\(\mathbb{E}[y_{t,d} \mid y_{1:T}]\)</span> and standard deviations <span class="math notranslate nohighlight">\(\mathrm{std}[y_{t,d} \mid y_{1:T}]\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<em>Float</em>[Array, ‘ntime emission_dim’], <em>Float</em>[Array, ‘ntime emission_dim’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an E-step to compute expected sufficient statistics under the posterior, <span class="math notranslate nohighlight">\(p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'nseq ntime emission_dim'</em><em>]</em>) – emissions <span class="math notranslate nohighlight">\(y_{1:T}\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'nseq ntime input_dim'</em><em>]</em><em>]</em>) – optional inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected sufficient statistics under the posterior.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<em>SuffStatsLGSSM</em>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an M-step to find parameters that maximize the expected log joint probability.</p>
<p>Specifically, compute</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \mathbb{E}_{p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)} \big[\log p(y_{1:T}, z_{1:T}, \theta \mid u_{1:T}) \big]\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>batch_stats</strong> (<em>SuffStatsLGSSM</em>) – sufficient statistics from each sequence</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>) – any required state for optimizing the model parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id4">
<h2>Low-level inference<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_filter">
<span class="sig-name descname"><span class="pre">lgssm_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a Kalman filter to produce the marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered posterior object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered">PosteriorGSSMFiltered</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_smoother">
<span class="sig-name descname"><span class="pre">lgssm_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run forward-filtering, backward-smoother to compute expectations
under the posterior distribution on latent states. Technically, this
implements the Rauch-Tung-Striebel (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – an LGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothed posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed" title="dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed">PosteriorGSSMSmoothed</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_posterior_sample">
<span class="sig-name descname"><span class="pre">lgssm_posterior_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_posterior_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Run forward-filtering, backward-sampling to draw samples from <span class="math notranslate nohighlight">\(p(x_{1:T} \mid y_{1:T}, u_{1:T})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Array</em><em>, </em><em>PRNGKeyArray</em><em>]</em>) – random number key.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional sequence of inptus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>one sample of <span class="math notranslate nohighlight">\(x_{1:T}\)</span> from the posterior distribution on latent states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Float[Array, “ntime state_dim”]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id5">
<h2>Types<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of a linear Gaussian SSM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMInitial"><em>ParamsLGSSMInitial</em></a>) – initial distribution parameters</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMDynamics"><em>ParamsLGSSMDynamics</em></a>) – dynamics distribution parameters</p></li>
<li><p><strong>emissions</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMEmissions"><em>ParamsLGSSMEmissions</em></a>) – emission distribution parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMInitial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMInitial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMInitial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the initial distribution</p>
<p><div class="math notranslate nohighlight">
\[p(x_1) = \mathcal{N}(x_1 \mid \mu_1, Q_1)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_1\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – <span class="math notranslate nohighlight">\(Q_1\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the emission distribution</p>
<p><div class="math notranslate nohighlight">
\[p(x_{t+1} \mid x_t, u_t) = \mathcal{N}(x_{t+1} \mid F x_t + B u_t + b, Q)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – dynamics weights <span class="math notranslate nohighlight">\(F\)</span></p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – dynamics bias <span class="math notranslate nohighlight">\(b\)</span></p></li>
<li><p><strong>input_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim input_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – dynamics input weights <span class="math notranslate nohighlight">\(B\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – dynamics covariance <span class="math notranslate nohighlight">\(Q\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMEmissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMEmissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the emission distribution</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid x_t, u_t) = \mathcal{N}(y_t \mid H x_t + D u_t + d, R)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim state_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – emission weights <span class="math notranslate nohighlight">\(H\)</span></p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – emission bias <span class="math notranslate nohighlight">\(d\)</span></p></li>
<li><p><strong>input_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim input_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – emission input weights <span class="math notranslate nohighlight">\(D\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>, </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em>]</em>) – emission covariance <span class="math notranslate nohighlight">\(R\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PosteriorGSSMFiltered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_covariances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#PosteriorGSSMFiltered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="Permalink to this definition">¶</a></dt>
<dd><p>Marginals of the Gaussian filtering posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – marginal log likelihood, <span class="math notranslate nohighlight">\(p(y_{1:T} \mid u_{1:T})\)</span></p></li>
<li><p><strong>filtered_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of filtered means <span class="math notranslate nohighlight">\(\mathbb{E}[x_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>filtered_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of filtered covariances <span class="math notranslate nohighlight">\(\mathrm{Cov}[x_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PosteriorGSSMSmoothed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_cross_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#PosteriorGSSMSmoothed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed" title="Permalink to this definition">¶</a></dt>
<dd><p>Marginals of the Gaussian filtering and smoothing posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em><em>]</em>) – marginal log likelihood, <span class="math notranslate nohighlight">\(p(y_{1:T} \mid u_{1:T})\)</span></p></li>
<li><p><strong>filtered_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of filtered means <span class="math notranslate nohighlight">\(\mathbb{E}[x_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>filtered_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of filtered covariances <span class="math notranslate nohighlight">\(\mathrm{Cov}[x_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>smoothed_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of smoothed means <span class="math notranslate nohighlight">\(\mathbb{E}[x_t \mid y_{1:T}, u_{1:T}]\)</span></p></li>
<li><p><strong>smoothed_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of smoothed marginal covariances, <span class="math notranslate nohighlight">\(\mathrm{Cov}[x_t \mid y_{1:T}, u_{1:T}]\)</span></p></li>
<li><p><strong>smoothed_cross_covariances</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em><em>]</em>) – array of smoothed cross products, <span class="math notranslate nohighlight">\(\mathbb{E}[x_t x_{t+1}^T \mid y_{1:T}, u_{1:T}]\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="nonlinear-gaussian-gssm">
<h1>Nonlinear Gaussian GSSM<a class="headerlink" href="#nonlinear-gaussian-gssm" title="Permalink to this heading">¶</a></h1>
<section id="id6">
<h2>High-level class<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NonlinearGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Nonlinear Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(x_t | x_{t-1}, u_t) = N(x_t | f(x_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | x_t) = N(y_t | h(x_t, u_t), R_t)\]</div>

<div class="math notranslate nohighlight">
\[p(x_1) = N(x_1 | m, S)\]</div>
</p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_t\)</span> = hidden variables of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <cite>input_dim</cite> (defaults to 0).</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> = dynamics (transition) function</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> = emission (observation) function</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = covariance matrix of dynamics (system) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> = covariance matrix for emission (observation) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = mean of initial state</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = covariance matrix of initial state</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s emissions.</p>
<p>For example, a <cite>GaussianHMM</cite> with <span class="math notranslate nohighlight">\(D\)</span> dimensional emissions would return <cite>(D,)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – optional  inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution over initial latent state, <span class="math notranslate nohighlight">\(p(x_1 \mid \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state <span class="math notranslate nohighlight">\(p(x_{t+1} \mid x_t, u_t, \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission <span class="math notranslate nohighlight">\(p(y_t \mid x_t, u_t, \theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id7">
<h2>Low-level inference<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.extended_kalman_filter">
<span class="sig-name descname"><span class="pre">extended_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#extended_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an (iterated) extended Kalman filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter">
<span class="sig-name descname"><span class="pre">iterated_extended_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#iterated_extended_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated extended Kalman filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around posterior for update step (default 2).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother">
<span class="sig-name descname"><span class="pre">extended_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#extended_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an extended Kalman (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>filtered_posterior</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMFiltered"><em>PosteriorGSSMFiltered</em></a><em>]</em>) – optional output from filtering step.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother">
<span class="sig-name descname"><span class="pre">iterated_extended_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#iterated_extended_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated extended Kalman smoother (IEKS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around posterior for update step (default 2).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter">
<span class="sig-name descname"><span class="pre">unscented_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ukf.html#unscented_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a unscented Kalman filter to produce the marginal likelihood and
filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>hyperparams</strong> (<em>UKFHyperParams</em>) – hyper-parameters.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother">
<span class="sig-name descname"><span class="pre">unscented_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ukf.html#unscented_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a unscented Kalman (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>hyperperams</strong> – hyper-parameters.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional inputs.</p></li>
<li><p><strong>hyperparams</strong> (<em>UKFHyperParams</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id8">
<h2>Types<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsNLGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#ParamsNLGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters for a NLGSSM model.</p>
<p><div class="math notranslate nohighlight">
\[p(x_t | x_{t-1}, u_t) = N(x_t | f(x_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | x_t) = N(y_t | h(x_t, u_t), R_t)\]</div>

<div class="math notranslate nohighlight">
\[p(x_1) = N(x_1 | m, S)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(f\)</span></p></li>
<li><p><strong>dynamics_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(Q\)</span></p></li>
<li><p><strong>emissions_function</strong> – <span class="math notranslate nohighlight">\(h\)</span></p></li>
<li><p><strong>emissions_covariance</strong> – <span class="math notranslate nohighlight">\(R\)</span></p></li>
<li><p><strong>initial_mean</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(m\)</span></p></li>
<li><p><strong>initial_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – </p></li>
<li><p><strong>emission_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>emission_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Params initial_covariance<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(S\)</span></p>
</dd>
</dl>
<p>If you have no inputs, the dynamics and emission functions do not to take <span class="math notranslate nohighlight">\(u_t\)</span> as an argument.</p>
</dd></dl>

</section>
</section>
<section id="generalized-gaussian-gssm">
<h1>Generalized Gaussian GSSM<a class="headerlink" href="#generalized-gaussian-gssm" title="Permalink to this heading">¶</a></h1>
<section id="id9">
<h2>High-level class<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GeneralizedGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(x_t | x_{t-1}, u_t) = N(x_t | f(x_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | x_t) = q(y_t | h(x_t, u_t), R(x_t, u_t))\]</div>

<div class="math notranslate nohighlight">
\[p(z_1) = N(x_1 | m, S)\]</div>
</p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_t\)</span> = hidden variables of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <cite>input_dim</cite> (defaults to 0).</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> = dynamics (transition) function</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> = emission (observation) function</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = covariance matrix of dynamics (system) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> = covariance function for emission (observation) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = mean of initial state</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = covariance matrix of initial state</p></li>
</ul>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s emissions.</p>
<p>For example, a <cite>GaussianHMM</cite> with <span class="math notranslate nohighlight">\(D\)</span> dimensional emissions would return <cite>(D,)</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – optional  inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution over initial latent state, <span class="math notranslate nohighlight">\(p(x_1 \mid \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state <span class="math notranslate nohighlight">\(p(x_{t+1} \mid x_t, u_t, \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(x_t\)</span></p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission <span class="math notranslate nohighlight">\(p(y_t \mid x_t, u_t, \theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id10">
<h2>Low-level inference<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter">
<span class="sig-name descname"><span class="pre">conditional_moments_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#conditional_moments_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an (iterated) conditional moments Gaussian filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>EKFIntegrals</em><em>, </em><em>UKFIntegrals</em><em>, </em><em>GHKFIntegrals</em><em>]</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optopnal array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter">
<span class="sig-name descname"><span class="pre">iterated_conditional_moments_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#iterated_conditional_moments_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated conditional moments Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>EKFIntegrals</em><em>, </em><em>UKFIntegrals</em><em>, </em><em>GHKFIntegrals</em><em>]</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother">
<span class="sig-name descname"><span class="pre">conditional_moments_gaussian_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#conditional_moments_gaussian_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a conditional moments Gaussian smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>EKFIntegrals</em><em>, </em><em>UKFIntegrals</em><em>, </em><em>GHKFIntegrals</em><em>]</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optopnal array of inputs.</p></li>
<li><p><strong>filtered_posterior</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMFiltered"><em>PosteriorGSSMFiltered</em></a><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother">
<span class="sig-name descname"><span class="pre">iterated_conditional_moments_gaussian_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#iterated_conditional_moments_gaussian_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated conditional moments Gaussian smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>EKFIntegrals</em><em>, </em><em>UKFIntegrals</em><em>, </em><em>GHKFIntegrals</em><em>]</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – optopnal array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id11">
<h2>Types<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.ParamsGGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsGGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_mean_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_cov_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dist=&lt;class</span> <span class="pre">'tensorflow_probability.substrates.jax.distributions.mvn_full_covariance.MultivariateNormalFullCovariance'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#ParamsGGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for GGSSM parameters. Differs from NLGSSM in terms of emission model.</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<p><div class="math notranslate nohighlight">
\[p(x_t | x_{t-1}, u_t) = N(x_t | f(x_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | x_t) = q(y_t | h(x_t, u_t), R(x_t, u_t))\]</div>

<div class="math notranslate nohighlight">
\[p(z_1) = N(x_1 | m, S)\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_mean</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(m\)</span></p></li>
<li><p><strong>initial_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(S\)</span></p></li>
<li><p><strong>dynamics_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(f\)</span></p></li>
<li><p><strong>dynamics_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(Q\)</span></p></li>
<li><p><strong>emissions_mean_function</strong> – <span class="math notranslate nohighlight">\(h\)</span></p></li>
<li><p><strong>emissions_cov_function</strong> – <span class="math notranslate nohighlight">\(R\)</span></p></li>
<li><p><strong>emission_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>]</em><em>, </em><em>Distribution</em><em>]</em>) – the observation pdf <span class="math notranslate nohighlight">\(q\)</span>. Constructed from specified mean and covariance.</p></li>
<li><p><strong>emission_mean_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>emission_cov_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<p>If you have no inputs, the dynamics and emission functions do not to take <span class="math notranslate nohighlight">\(u_t\)</span> as an argument.</p>
</dd></dl>

</section>
</section>
<section id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.utils.utils.find_permutation">
<span class="sig-name descname"><span class="pre">find_permutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/utils/utils.html#find_permutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.utils.utils.find_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the permutation of the state labels in sequence <code class="docutils literal notranslate"><span class="pre">z1</span></code> so that they
best align with the labels in <code class="docutils literal notranslate"><span class="pre">z2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z1</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps'</em><em>]</em>) – The first state vector.</p></li>
<li><p><strong>z2</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps'</em><em>]</em>) – The second state vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>permutation such that <code class="docutils literal notranslate"><span class="pre">jnp.take(perm,</span> <span class="pre">z1)</span></code> best aligns with <code class="docutils literal notranslate"><span class="pre">z2</span></code>.
Thus, <code class="docutils literal notranslate"><span class="pre">len(perm)</span> <span class="pre">=</span> <span class="pre">min(z1.max(),</span> <span class="pre">z2.max())</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html" title="previous page">Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy<br/>
        
            &copy; Copyright 2022, Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>