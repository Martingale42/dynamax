
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>State Space Model (Base class)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Terminology for types" href="types.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.gif" class="logo__image only-light" alt=" - Home"/>
    <img src="_static/logo.gif" class="logo__image only-dark pst-js-only" alt=" - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">HMMs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/casino_hmm_inference.html">Casino HMM: Inference (state estimation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/casino_hmm_learning.html">Casino HMM: Learning (parameter estimation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/gaussian_hmm.html">Gaussian HMM: Cross-validation and Model Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/autoregressive_hmm.html">Autoregressive (AR) HMM Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Gaussian SSMs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking.html">Tracking an object using the Kalman filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_linreg.html">Online linear regression using Kalman filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_parallel_inference.html">Parallel filtering and smoothing in an LG-SSM</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_learning.html">MAP parameter estimation for an LG-SSM using EM and SGD</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_hmc.html">Bayesian parameter estimation for an LG-SSM using HMC</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nonlinear Gaussian SSMs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_spiral.html">Tracking a spiraling object using the extended / unscented Kalman filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_pendulum.html">Tracking a 1d pendulum using Extended / Unscented Kalman filter/ smoother</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_mlp.html">Online learning for an MLP using extended Kalman filtering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Generalized Gaussian SSMs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_logistic_regression_demo.html">Online Logistic Regression using conditional moments Gaussian filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_mlp_classification_demo.html">Online learning of an MLP Classifier using conditional moments Gaussian filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html">Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="types.html">Terminology for types</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">State Space Model (Base class)</a></li>





</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/probml/dynamax" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>State Space Model (Base class)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">State Space Model (Base class)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM"><code class="docutils literal notranslate"><span class="pre">SSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">SSM.initial_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">SSM.transition_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">SSM.emission_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prior"><code class="docutils literal notranslate"><span class="pre">SSM.log_prior()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">SSM.emission_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.inputs_shape"><code class="docutils literal notranslate"><span class="pre">SSM.inputs_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.sample"><code class="docutils literal notranslate"><span class="pre">SSM.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prob"><code class="docutils literal notranslate"><span class="pre">SSM.log_prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.marginal_log_prob"><code class="docutils literal notranslate"><span class="pre">SSM.marginal_log_prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.filter"><code class="docutils literal notranslate"><span class="pre">SSM.filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.smoother"><code class="docutils literal notranslate"><span class="pre">SSM.smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.e_step"><code class="docutils literal notranslate"><span class="pre">SSM.e_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.m_step"><code class="docutils literal notranslate"><span class="pre">SSM.m_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_em"><code class="docutils literal notranslate"><span class="pre">SSM.fit_em()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_sgd"><code class="docutils literal notranslate"><span class="pre">SSM.fit_sgd()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.parameters.ParameterSet"><code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.parameters.PropertySet"><code class="docutils literal notranslate"><span class="pre">PropertySet</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.parameters.ParameterProperties"><code class="docutils literal notranslate"><span class="pre">ParameterProperties</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hidden-markov-model">Hidden Markov Model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abstract-classes">Abstract classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-level-models">High-level models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-level-inference">Low-level inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types">Types</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-gaussian-ssm">Linear Gaussian SSM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-level-class">High-level class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.emission_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.inputs_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.initialize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.initial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.transition_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.emission_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.sample"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.sample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.marginal_log_prob()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.filter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.smoother()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_sample"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.posterior_sample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.posterior_predictive()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.e_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize_m_step_state"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.initialize_m_step_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.m_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Low-level inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_filter"><code class="docutils literal notranslate"><span class="pre">lgssm_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_smoother"><code class="docutils literal notranslate"><span class="pre">lgssm_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample"><code class="docutils literal notranslate"><span class="pre">lgssm_posterior_sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSM</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSMInitial</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSMDynamics</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSMEmissions</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered"><code class="docutils literal notranslate"><span class="pre">PosteriorGSSMFiltered</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed"><code class="docutils literal notranslate"><span class="pre">PosteriorGSSMSmoothed</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-gaussian-gssm">Nonlinear Gaussian GSSM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">High-level class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.emission_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.inputs_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.initial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.transition_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.emission_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Low-level inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter"><code class="docutils literal notranslate"><span class="pre">extended_kalman_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter"><code class="docutils literal notranslate"><span class="pre">iterated_extended_kalman_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother"><code class="docutils literal notranslate"><span class="pre">extended_kalman_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother"><code class="docutils literal notranslate"><span class="pre">iterated_extended_kalman_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter"><code class="docutils literal notranslate"><span class="pre">unscented_kalman_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother"><code class="docutils literal notranslate"><span class="pre">unscented_kalman_smoother()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM"><code class="docutils literal notranslate"><span class="pre">ParamsNLGSSM</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generalized-gaussian-gssm">Generalized Gaussian GSSM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">High-level class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.emission_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.covariates_shape"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.covariates_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.initial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.transition_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.emission_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Low-level inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter"><code class="docutils literal notranslate"><span class="pre">conditional_moments_gaussian_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter"><code class="docutils literal notranslate"><span class="pre">iterated_conditional_moments_gaussian_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother"><code class="docutils literal notranslate"><span class="pre">conditional_moments_gaussian_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother"><code class="docutils literal notranslate"><span class="pre">iterated_conditional_moments_gaussian_smoother()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM"><code class="docutils literal notranslate"><span class="pre">ParamsGGSSM</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#utilities">Utilities</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.utils.utils.find_permutation"><code class="docutils literal notranslate"><span class="pre">find_permutation()</span></code></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="state-space-model-base-class">
<h1>State Space Model (Base class)<a class="headerlink" href="#state-space-model-base-class" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.ssm.SSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SSM</span></span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM" title="Link to this definition">#</a></dt>
<dd><p>A base class for state space models. Such models consist of parameters, which
we may learn, as well as hyperparameters, which specify static properties of the
model. This base class allows parameters to be indicated a standardized way
so that they can easily be converted to/from unconstrained form for optimization.</p>
<p><strong>Abstract Methods</strong></p>
<p>Models that inherit from <cite>SSM</cite> must implement a few key functions and properties:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.initial_distribution" title="dynamax.ssm.SSM.initial_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initial_distribution()</span></code></a> returns the distribution over the initial state given parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.transition_distribution" title="dynamax.ssm.SSM.transition_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transition_distribution()</span></code></a> returns the conditional distribution over the next state given the current state and parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.emission_distribution" title="dynamax.ssm.SSM.emission_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">emission_distribution()</span></code></a> returns the conditional distribution over the emission given the current state and parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.log_prior" title="dynamax.ssm.SSM.log_prior"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_prior()</span></code></a> (optional) returns the log prior probability of the parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.emission_shape" title="dynamax.ssm.SSM.emission_shape"><code class="xref py py-attr docutils literal notranslate"><span class="pre">emission_shape</span></code></a> returns a tuple specification of the emission shape</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.inputs_shape" title="dynamax.ssm.SSM.inputs_shape"><code class="xref py py-attr docutils literal notranslate"><span class="pre">inputs_shape</span></code></a> returns a tuple specification of the input shape, or <cite>None</cite> if there are no inputs.</p></li>
</ul>
<p>The shape properties are required for properly handling batches of data.</p>
<p><strong>Sampling and Computing Log Probabilities</strong></p>
<p>Once these have been implemented, subclasses will inherit the ability to sample
and compute log joint probabilities from the base class functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.sample" title="dynamax.ssm.SSM.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> draws samples of the states and emissions for given parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.log_prob" title="dynamax.ssm.SSM.log_prob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_prob()</span></code></a> computes the log joint probability of the states and emissions for given parameters</p></li>
</ul>
<p><strong>Inference</strong></p>
<p>Many subclasses of SSMs expose basic functions for performing state inference.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.marginal_log_prob" title="dynamax.ssm.SSM.marginal_log_prob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">marginal_log_prob()</span></code></a> computes the marginal log probability of the emissions, summing over latent states</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.filter" title="dynamax.ssm.SSM.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a> computes the filtered posteriors</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.smoother" title="dynamax.ssm.SSM.smoother"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smoother()</span></code></a> computes the smoothed posteriors</p></li>
</ul>
<p><strong>Learning</strong></p>
<p>Likewise, many SSMs will support learning with expectation-maximization (EM) or stochastic gradient descent (SGD).</p>
<p>For expectation-maximization, subclasses must implement the E- and M-steps.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.e_step" title="dynamax.ssm.SSM.e_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">e_step()</span></code></a> computes the expected sufficient statistics for a sequence of emissions, given parameters</p></li>
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.m_step" title="dynamax.ssm.SSM.m_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">m_step()</span></code></a> finds new parameters that maximize the expected log joint probability</p></li>
</ul>
<p>Once these are implemented, the generic SSM class allows to fit the model with EM</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.fit_em" title="dynamax.ssm.SSM.fit_em"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_em()</span></code></a> run EM to find parameters that maximize the likelihood (or posterior) probability.</p></li>
</ul>
<p>For SGD, any subclass that implements <a class="reference internal" href="#dynamax.ssm.SSM.marginal_log_prob" title="dynamax.ssm.SSM.marginal_log_prob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">marginal_log_prob()</span></code></a> inherits the base class fitting function</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dynamax.ssm.SSM.fit_sgd" title="dynamax.ssm.SSM.fit_sgd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_sgd()</span></code></a> run SGD to minimize the <em>negative</em> marginal log probability.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.initial_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.initial_distribution" title="Link to this definition">#</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional  inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution over initial latent state, <span class="math notranslate nohighlight">\(p(z_1 \mid \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.transition_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.transition_distribution" title="Link to this definition">#</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state <span class="math notranslate nohighlight">\(p(z_{t+1} \mid z_t, u_t, \theta)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.emission_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.emission_distribution" title="Link to this definition">#</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission <span class="math notranslate nohighlight">\(p(y_t \mid z_t, u_t, \theta)\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.log_prior">
<span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.log_prior" title="Link to this definition">#</a></dt>
<dd><p>Return the log prior probability of any model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log prior probability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lp (Scalar)</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.emission_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamax.ssm.SSM.emission_shape" title="Link to this definition">#</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s emissions.</p>
<p>For example, a <cite>GaussianHMM</cite> with <span class="math notranslate nohighlight">\(D\)</span> dimensional emissions would return <cite>(D,)</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#dynamax.ssm.SSM.inputs_shape" title="Link to this definition">#</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.sample" title="Link to this definition">#</a></dt>
<dd><p>Sample states <span class="math notranslate nohighlight">\(z_{1:T}\)</span> and emissions <span class="math notranslate nohighlight">\(y_{1:T}\)</span> given parameters <span class="math notranslate nohighlight">\(\theta\)</span> and (optionally) inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – random number generator</p></li>
<li><p><strong>num_timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of timesteps <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>latent states and emissions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<em>Float</em>[Array, ‘num_timesteps state_dim’], <em>Float</em>[Array, ‘num_timesteps emission_dim’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.log_prob" title="Link to this definition">#</a></dt>
<dd><p>Compute the log joint probability of the states and observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>)</p></li>
<li><p><strong>states</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps state_dim'</em><em>]</em>)</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> | <em>Float</em>[Array, ‘’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.marginal_log_prob">
<span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.marginal_log_prob" title="Link to this definition">#</a></dt>
<dd><p>Compute log marginal likelihood of observations, <span class="math notranslate nohighlight">\(\log \sum_{z_{1:T}} p(y_{1:T}, z_{1:T} \mid \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>marginal log probability</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> | <em>Float</em>[Array, ‘’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.filter" title="Link to this definition">#</a></dt>
<dd><p>Compute filtering distributions, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:t}, u_{1:t}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtering distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Posterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.smoother" title="Link to this definition">#</a></dt>
<dd><p>Compute smoothing distribution, <span class="math notranslate nohighlight">\(p(z_t \mid y_{1:T}, u_{1:T}, \theta)\)</span> for <span class="math notranslate nohighlight">\(t=1,\ldots,T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>state</strong> – current latent state <span class="math notranslate nohighlight">\(z_t\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – current inputs  <span class="math notranslate nohighlight">\(u_t\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothing distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Posterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.e_step" title="Link to this definition">#</a></dt>
<dd><p>Perform an E-step to compute expected sufficient statistics under the posterior, <span class="math notranslate nohighlight">\(p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – emissions <span class="math notranslate nohighlight">\(y_{1:T}\)</span></p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional inputs <span class="math notranslate nohighlight">\(u_{1:T}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expected sufficient statistics under the posterior.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<em>SuffStatsSSM</em>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> | <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.m_step" title="Link to this definition">#</a></dt>
<dd><p>Perform an M-step to find parameters that maximize the expected log joint probability.</p>
<p>Specifically, compute</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \mathbb{E}_{p(z_{1:T} \mid y_{1:T}, u_{1:T}, \theta)} \big[\log p(y_{1:T}, z_{1:T}, \theta \mid u_{1:T}) \big]\]</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>batch_stats</strong> (<em>SuffStatsSSM</em>) – sufficient statistics from each sequence</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>) – any required state for optimizing the model parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new parameters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.fit_em">
<span class="sig-name descname"><span class="pre">fit_em</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.fit_em"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.fit_em" title="Link to this definition">#</a></dt>
<dd><p>Compute parameter MLE/ MAP estimate using Expectation-Maximization (EM).</p>
<p>EM aims to find parameters that maximize the marginal log probability,</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \log p(y_{1:T}, \theta \mid u_{1:T})\]</div>
</p>
<p>It does so by iteratively forming a lower bound (the “E-step”) and then maximizing it (the “M-step”).</p>
<p><em>Note:</em> <code class="docutils literal notranslate"><span class="pre">emissions</span></code> <em>and</em> <code class="docutils literal notranslate"><span class="pre">inputs</span></code> <em>can either be single sequences or batches of sequences.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>emissions</strong> (<em>Real</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>] </em><em>| </em><em>Real</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps emission_dim'</em><em>]</em>) – one or more sequences of emissions</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – one or more sequences of corresponding inputs</p></li>
<li><p><strong>num_iters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of iterations of EM to run</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether or not to show a progress bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of new parameters and log likelihoods over the course of EM iterations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <em>Float</em>[Array, ‘num_iters’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.fit_sgd">
<span class="sig-name descname"><span class="pre">fit_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">params,</span> <span class="pre">props,</span> <span class="pre">emissions,</span> <span class="pre">inputs=None,</span> <span class="pre">optimizer=(&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;,</span> <span class="pre">&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;),</span> <span class="pre">batch_size=1,</span> <span class="pre">num_epochs=50,</span> <span class="pre">shuffle=False,</span> <span class="pre">key=Array([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.fit_sgd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.fit_sgd" title="Link to this definition">#</a></dt>
<dd><p>Compute parameter MLE/ MAP estimate using Stochastic Gradient Descent (SGD).</p>
<p>SGD aims to find parameters that maximize the marginal log probability,</p>
<p><div class="math notranslate nohighlight">
\[\theta^\star = \mathrm{argmax}_\theta \; \log p(y_{1:T}, \theta \mid u_{1:T})\]</div>
</p>
<p>by minimizing the _negative_ of that quantity.</p>
<p><em>Note:</em> <code class="docutils literal notranslate"><span class="pre">emissions</span></code> <em>and</em> <code class="docutils literal notranslate"><span class="pre">inputs</span></code> <em>can either be single sequences or batches of sequences.</em></p>
<p>On each iteration, the algorithm grabs a <em>minibatch</em> of sequences and takes a gradient step.
One pass through the entire set of sequences is called an <em>epoch</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>) – model parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><em>PropertySet</em></a>) – properties specifying which parameters should be learned</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps emission_dim'</em><em>]</em>) – one or more sequences of emissions</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – one or more sequences of corresponding inputs</p></li>
<li><p><strong>optimizer</strong> (<em>GradientTransformation</em>) – an <cite>optax</cite> optimizer for minimization</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of sequences per minibatch</p></li>
<li><p><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of epochs of SGD to run</p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – a random number generator for selecting minibatches</p></li>
<li><p><strong>verbose</strong> – whether or not to show a progress bar</p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of new parameters and losses (negative scaled marginal log probs) over the course of SGD iterations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><em>ParameterSet</em></a>, <em>Float</em>[Array, ‘niter’]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h2>
<p>Parameters and their associated properties are stored as <code class="xref py py-class docutils literal notranslate"><span class="pre">jax.DeviceArray</span></code>
and <a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamax.parameters.ParameterProperties</span></code></a>, respectively. They are bundled together into a
<a class="reference internal" href="#dynamax.parameters.ParameterSet" title="dynamax.parameters.ParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamax.parameters.ParameterSet</span></code></a> and a <a class="reference internal" href="#dynamax.parameters.PropertySet" title="dynamax.parameters.PropertySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamax.parameters.PropertySet</span></code></a>, which are simply
aliases for immutable datastructures (in our case,  <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code>).</p>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.parameters.ParameterSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/parameters.html#ParameterSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.parameters.ParameterSet" title="Link to this definition">#</a></dt>
<dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code> with parameters stored as <code class="xref py py-class docutils literal notranslate"><span class="pre">jax.DeviceArray</span></code> in the leaf nodes.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.parameters.PropertySet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PropertySet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/parameters.html#PropertySet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.parameters.PropertySet" title="Link to this definition">#</a></dt>
<dd><p>A matching <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code> with <a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterProperties</span></code></a> stored in the leaf nodes.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.parameters.ParameterProperties">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParameterProperties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrainer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/parameters.html#ParameterProperties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.parameters.ParameterProperties" title="Link to this definition">#</a></dt>
<dd><p>A PyTree containing parameter metadata (properties).</p>
<p>Note: the properties are stored in the aux_data of this PyTree so that
changes will trigger recompilation of functions that rely on them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – flag specifying whether or not to fit this parameter is adjustable.</p></li>
<li><p><strong>constrainer</strong> (<em>Optional tfb.Bijector</em>) – bijector mapping to constrained form.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="hidden-markov-model">
<h1>Hidden Markov Model<a class="headerlink" href="#hidden-markov-model" title="Link to this heading">#</a></h1>
<section id="abstract-classes">
<h2>Abstract classes<a class="headerlink" href="#abstract-classes" title="Link to this heading">#</a></h2>
</section>
<section id="high-level-models">
<h2>High-level models<a class="headerlink" href="#high-level-models" title="Link to this heading">#</a></h2>
<p>The HMM implementations below cover common emission distributions and,
if the emissions are exponential family distributions, the models implement
closed form EM updates. For HMMs with emissions outside the non-exponential family,
these models default to a generic M-step implemented in <code class="xref py py-class docutils literal notranslate"><span class="pre">HMMEmissions</span></code>.</p>
<p>Unless otherwise specified, these models have standard initial distributions and
transition distributions with conjugate, Bayesian priors on their parameters.</p>
<p><strong>Initial distribution:</strong></p>
<p><div class="math notranslate nohighlight">
\[p(z_1 \mid \pi_1) = \mathrm{Cat}(z_1 \mid \pi_1)\]</div>

<div class="math notranslate nohighlight">
\[p(\pi_1) = \mathrm{Dir}(\pi_1 \mid \alpha 1_K)\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the prior concentration on the initial distribution <span class="math notranslate nohighlight">\(\pi_1\)</span>.</p>
<p><strong>Transition distribution:</strong></p>
<p><div class="math notranslate nohighlight">
\[p(z_t \mid z_{t-1}, \theta) = \mathrm{Cat}(z_t \mid A_{z_{t-1}})\]</div>

<div class="math notranslate nohighlight">
\[p(A) = \prod_{k=1}^K \mathrm{Dir}(A_k \mid \beta 1_K + \kappa e_k)\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the prior concentration on the rows of the transition matrix <span class="math notranslate nohighlight">\(A\)</span>
and <span class="math notranslate nohighlight">\(\kappa\)</span> is the <cite>stickiness</cite>, which biases the prior toward transition matrices
with larger values along the diagonal.</p>
<p>These hyperparameters can be specified in the HMM constructors, and they
default to weak priors without any stickiness.</p>
</section>
<section id="low-level-inference">
<h2>Low-level inference<a class="headerlink" href="#low-level-inference" title="Link to this heading">#</a></h2>
</section>
<section id="types">
<h2>Types<a class="headerlink" href="#types" title="Link to this heading">#</a></h2>
</section>
</section>
<section id="linear-gaussian-ssm">
<h1>Linear Gaussian SSM<a class="headerlink" href="#linear-gaussian-ssm" title="Link to this heading">#</a></h1>
<section id="high-level-class">
<h2>High-level class<a class="headerlink" href="#high-level-class" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_dynamics_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_emissions_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM" title="Link to this definition">#</a></dt>
<dd><p>Linear Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(z_1) = \mathcal{N}(z_1 \mid m, S)\]</div>

<div class="math notranslate nohighlight">
\[p(z_t \mid z_{t-1}, u_t) = \mathcal{N}(z_t \mid F_t z_{t-1} + B_t u_t + b_t, Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t \mid z_t) = \mathcal{N}(y_t \mid H_t z_t + D_t u_t + d_t, R_t)\]</div>
</p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_t\)</span> is a latent state of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> is an emission of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> is an input of size <cite>input_dim</cite> (defaults to 0)</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span> = dynamics (transition) matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span> = optional input-to-state weight matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> = optional input-to-state bias vector</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = covariance matrix of dynamics (system) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span> = emission (observation) matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span> = optional input-to-emission weight matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> = optional input-to-emission bias vector</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> = covariance function for emission (observation) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = mean of initial state</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = covariance matrix of initial state</p></li>
</ul>
<p>The parameters of the model are stored in a <a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamsLGSSM</span></code></a>.
You can create the parameters manually, or by calling <a class="reference internal" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize" title="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of latent state.</p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of observation vector.</p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of input vector. Defaults to 0.</p></li>
<li><p><strong>has_dynamics_bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether model contains an offset term <span class="math notranslate nohighlight">\(b\)</span>. Defaults to True.</p></li>
<li><p><strong>has_emissions_bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether model contains an offset term <span class="math notranslate nohighlight">\(d\)</span>. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the emission vector.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the input vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Array([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_input_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_input_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize" title="Link to this definition">#</a></dt>
<dd><p>Initialize model parameters that are set to None, and their corresponding properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – Random number key. Defaults to jr.PRNGKey(0).</p></li>
<li><p><strong>initial_mean</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>] </em><em>| </em><em>None</em>) – parameter <span class="math notranslate nohighlight">\(m\)</span>. Defaults to None.</p></li>
<li><p><strong>initial_covariance</strong> – parameter <span class="math notranslate nohighlight">\(S\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_weights</strong> – parameter <span class="math notranslate nohighlight">\(F\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_bias</strong> – parameter <span class="math notranslate nohighlight">\(b\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_input_weights</strong> – parameter <span class="math notranslate nohighlight">\(B\)</span>. Defaults to None.</p></li>
<li><p><strong>dynamics_covariance</strong> – parameter <span class="math notranslate nohighlight">\(Q\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_weights</strong> – parameter <span class="math notranslate nohighlight">\(H\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_bias</strong> – parameter <span class="math notranslate nohighlight">\(d\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_input_weights</strong> – parameter <span class="math notranslate nohighlight">\(D\)</span>. Defaults to None.</p></li>
<li><p><strong>emission_covariance</strong> – parameter <span class="math notranslate nohighlight">\(R\)</span>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM">ParamsLGSSM</a>, <a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM">ParamsLGSSM</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution" title="Link to this definition">#</a></dt>
<dd><p>Return the initial distribution of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution" title="Link to this definition">#</a></dt>
<dd><p>Return the transition distribution of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>)</p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution" title="Link to this definition">#</a></dt>
<dd><p>Return the emission distribution of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>)</p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.sample" title="Link to this definition">#</a></dt>
<dd><p>Sample from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – random number key.</p></li>
<li><p><strong>num_timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of time steps.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of latent states and observations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<em>Float</em>[Array, ‘num_timesteps state_dim’], <em>Float</em>[Array, ‘num_timesteps emission_dim’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob">
<span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob" title="Link to this definition">#</a></dt>
<dd><p>Compute the marginal log likelihood of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>marginal log likelihood.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> | <em>Float</em>[Array, ‘’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter" title="Link to this definition">#</a></dt>
<dd><p>Compute the marginal filtering distribution for each time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>marginal filtering distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMFiltered"><em>PosteriorGSSMFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother" title="Link to this definition">#</a></dt>
<dd><p>Compute the posterior smoothing distribution for each time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior smoothing distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMSmoothed"><em>PosteriorGSSMSmoothed</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_sample">
<span class="sig-name descname"><span class="pre">posterior_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.posterior_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_sample" title="Link to this definition">#</a></dt>
<dd><p>Sample from the posterior distribution of the latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – random number key.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior samples of the latent states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Float</em>[Array, ‘num_timesteps state_dim’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive">
<span class="sig-name descname"><span class="pre">posterior_predictive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.posterior_predictive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive" title="Link to this definition">#</a></dt>
<dd><p>Compute marginal posterior predictive smoothing distribution for each observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior predictive means <span class="math notranslate nohighlight">\(\mathbb{E}[y_{t,d} \mid y_{1:T}]\)</span> and standard deviations <span class="math notranslate nohighlight">\(\mathrm{std}[y_{t,d} \mid y_{1:T}]\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<em>Float</em>[Array, ‘num_timesteps emission_dim’], <em>Float</em>[Array, ‘num_timesteps emission_dim’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step" title="Link to this definition">#</a></dt>
<dd><p>Compute expected sufficient statistics for the E-step of the EM algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps input_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_batches num_timesteps input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>expected sufficient statistics and marginal log likelihood.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<em>SuffStatsLGSSM</em>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> | <em>Float</em>[Array, ‘’]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize_m_step_state">
<span class="sig-name descname"><span class="pre">initialize_m_step_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initialize_m_step_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize_m_step_state" title="Link to this definition">#</a></dt>
<dd><p>Initialize the state for the M-step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>)</p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step">
<span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_step_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.m_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step" title="Link to this definition">#</a></dt>
<dd><p>Perform the M-step of the EM algorithm.</p>
<p>Note: This function currently ignores any <cite>trainable</cite> constraints specified
in the <cite>props</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>props</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – parameter properties.</p></li>
<li><p><strong>batch_stats</strong> (<em>SuffStatsLGSSM</em>) – expected sufficient statistics.</p></li>
<li><p><strong>m_step_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>) – state for the M-step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>updated model parameters and updated M-step state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id1">
<h2>Low-level inference<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_filter">
<span class="sig-name descname"><span class="pre">lgssm_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_filter" title="Link to this definition">#</a></dt>
<dd><p>Run a Kalman filter to produce the marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered posterior object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered">PosteriorGSSMFiltered</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_smoother">
<span class="sig-name descname"><span class="pre">lgssm_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_smoother" title="Link to this definition">#</a></dt>
<dd><p>Run forward-filtering, backward-smoother to compute expectations
under the posterior distribution on latent states. Technically, this
implements the Rauch-Tung-Striebel (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – an LGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothed posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed" title="dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed">PosteriorGSSMSmoothed</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_posterior_sample">
<span class="sig-name descname"><span class="pre">lgssm_posterior_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_posterior_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample" title="Link to this definition">#</a></dt>
<dd><p>Run forward-filtering, backward-sampling to draw samples from <span class="math notranslate nohighlight">\(p(z_{1:T} \mid y_{1:T}, u_{1:T})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>Array</em></a>) – random number key.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – sequence of observations.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional sequence of inptus.</p></li>
<li><p><strong>jitter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>None</em>) – padding to add to the diagonal of the covariance matrix before sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>one sample of <span class="math notranslate nohighlight">\(z_{1:T}\)</span> from the posterior distribution on latent states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Float[Array, “ntime state_dim”]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id2">
<h2>Types<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="Link to this definition">#</a></dt>
<dd><p>Parameters of a linear Gaussian SSM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMInitial"><em>ParamsLGSSMInitial</em></a>) – initial distribution parameters</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMDynamics"><em>ParamsLGSSMDynamics</em></a>) – dynamics distribution parameters</p></li>
<li><p><strong>emissions</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMEmissions"><em>ParamsLGSSMEmissions</em></a>) – emission distribution parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMInitial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMInitial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMInitial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial" title="Link to this definition">#</a></dt>
<dd><p>Parameters of the initial distribution</p>
<p><div class="math notranslate nohighlight">
\[p(z_1) = \mathcal{N}(z_1 \mid \mu_1, Q_1)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>] </em><em>| </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a>) – <span class="math notranslate nohighlight">\(\mu_1\)</span></p></li>
<li><p><strong>cov</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim_triu'</em><em>] </em><em>| </em><a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a>) – <span class="math notranslate nohighlight">\(Q_1\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics" title="Link to this definition">#</a></dt>
<dd><p>Parameters of the emission distribution</p>
<p><div class="math notranslate nohighlight">
\[p(z_{t+1} \mid z_t, u_t) = \mathcal{N}(z_{t+1} \mid F z_t + B u_t + b, Q)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – dynamics weights <span class="math notranslate nohighlight">\(F\)</span></p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – dynamics bias <span class="math notranslate nohighlight">\(b\)</span></p></li>
<li><p><strong>input_weights</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim input_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim input_dim'</em><em>]</em>) – dynamics input weights <span class="math notranslate nohighlight">\(B\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim_triu'</em><em>]</em>) – dynamics covariance <span class="math notranslate nohighlight">\(Q\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMEmissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMEmissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions" title="Link to this definition">#</a></dt>
<dd><p>Parameters of the emission distribution</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid z_t, u_t) = \mathcal{N}(y_t \mid H z_t + D u_t + d, R)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim state_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim state_dim'</em><em>]</em>) – emission weights <span class="math notranslate nohighlight">\(H\)</span></p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – emission bias <span class="math notranslate nohighlight">\(d\)</span></p></li>
<li><p><strong>input_weights</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim input_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim input_dim'</em><em>]</em>) – emission input weights <span class="math notranslate nohighlight">\(D\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference internal" href="#dynamax.parameters.ParameterProperties" title="dynamax.parameters.ParameterProperties"><em>ParameterProperties</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim_triu'</em><em>]</em>) – emission covariance <span class="math notranslate nohighlight">\(R\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PosteriorGSSMFiltered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#PosteriorGSSMFiltered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="Link to this definition">#</a></dt>
<dd><p>Marginals of the Gaussian filtering posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>] </em><em>| </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime'</em><em>]</em>) – marginal log likelihood, <span class="math notranslate nohighlight">\(p(y_{1:T} \mid u_{1:T})\)</span></p></li>
<li><p><strong>filtered_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>] </em><em>| </em><em>None</em>) – array of filtered means <span class="math notranslate nohighlight">\(\mathbb{E}[z_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>filtered_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>] </em><em>| </em><em>None</em>) – array of filtered covariances <span class="math notranslate nohighlight">\(\mathrm{Cov}[z_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>predicted_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>predicted_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PosteriorGSSMSmoothed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_cross_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#PosteriorGSSMSmoothed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed" title="Link to this definition">#</a></dt>
<dd><p>Marginals of the Gaussian filtering and smoothing posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>) – marginal log likelihood, <span class="math notranslate nohighlight">\(p(y_{1:T} \mid u_{1:T})\)</span></p></li>
<li><p><strong>filtered_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of filtered means <span class="math notranslate nohighlight">\(\mathbb{E}[z_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>filtered_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of filtered covariances <span class="math notranslate nohighlight">\(\mathrm{Cov}[z_t \mid y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>smoothed_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of smoothed means <span class="math notranslate nohighlight">\(\mathbb{E}[z_t \mid y_{1:T}, u_{1:T}]\)</span></p></li>
<li><p><strong>smoothed_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of smoothed marginal covariances, <span class="math notranslate nohighlight">\(\mathrm{Cov}[z_t \mid y_{1:T}, u_{1:T}]\)</span></p></li>
<li><p><strong>smoothed_cross_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime_minus1 state_dim state_dim'</em><em>] </em><em>| </em><em>None</em>) – array of smoothed cross products, <span class="math notranslate nohighlight">\(\mathbb{E}[z_t z_{t+1}^T \mid y_{1:T}, u_{1:T}]\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="nonlinear-gaussian-gssm">
<h1>Nonlinear Gaussian GSSM<a class="headerlink" href="#nonlinear-gaussian-gssm" title="Link to this heading">#</a></h1>
<section id="id3">
<h2>High-level class<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NonlinearGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM" title="Link to this definition">#</a></dt>
<dd><p>Nonlinear Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(z_t | z_{t-1}, u_t) = N(z_t | f(z_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | z_t) = N(y_t | h(z_t, u_t), R_t)\]</div>

<div class="math notranslate nohighlight">
\[p(z_1) = N(z_1 | m, S)\]</div>
</p>
<p>where the model parameters are</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_t\)</span> = hidden variables of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <cite>input_dim</cite> (defaults to 0).</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> = dynamics (transition) function</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> = emission (observation) function</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = covariance matrix of dynamics (system) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> = covariance matrix for emission (observation) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = mean of initial state</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = covariance matrix of initial state</p></li>
</ul>
<p>These parameters of the model are stored in a separate object of type <a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamsNLGSSM</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape" title="Link to this definition">#</a></dt>
<dd><p>Returns the shape of the emission distribution.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape" title="Link to this definition">#</a></dt>
<dd><p>Returns the shape of the input distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution" title="Link to this definition">#</a></dt>
<dd><p>Returns the initial distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution" title="Link to this definition">#</a></dt>
<dd><p>Returns the nonlinear dynamics distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>)</p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution" title="Link to this definition">#</a></dt>
<dd><p>Returns the nonlinear emission distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>)</p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id4">
<h2>Low-level inference<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.extended_kalman_filter">
<span class="sig-name descname"><span class="pre">extended_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['filtered_means',</span> <span class="pre">'filtered_covariances',</span> <span class="pre">'predicted_means',</span> <span class="pre">'predicted_covariances']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#extended_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter" title="Link to this definition">#</a></dt>
<dd><p>Run an (iterated) extended Kalman filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of linearizations around posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
<li><p><strong>output_fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – list of fields to return in posterior object.
These can take the values “filtered_means”, “filtered_covariances”,
“predicted_means”, “predicted_covariances”, and “marginal_loglik”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter">
<span class="sig-name descname"><span class="pre">iterated_extended_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#iterated_extended_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter" title="Link to this definition">#</a></dt>
<dd><p>Run an iterated extended Kalman filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of linearizations around posterior for update step (default 2).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother">
<span class="sig-name descname"><span class="pre">extended_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#extended_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother" title="Link to this definition">#</a></dt>
<dd><p>Run an extended Kalman (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>filtered_posterior</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMFiltered"><em>PosteriorGSSMFiltered</em></a><em> | </em><em>None</em>) – optional output from filtering step.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother">
<span class="sig-name descname"><span class="pre">iterated_extended_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#iterated_extended_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother" title="Link to this definition">#</a></dt>
<dd><p>Run an iterated extended Kalman smoother (IEKS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – observation sequence.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of linearizations around posterior for update step (default 2).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter">
<span class="sig-name descname"><span class="pre">unscented_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['filtered_means',</span> <span class="pre">'filtered_covariances',</span> <span class="pre">'predicted_means',</span> <span class="pre">'predicted_covariances']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ukf.html#unscented_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter" title="Link to this definition">#</a></dt>
<dd><p>Run a unscented Kalman filter to produce the marginal likelihood and
filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>hyperparams</strong> (<em>UKFHyperParams</em>) – hyper-parameters.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
<li><p><strong>output_fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother">
<span class="sig-name descname"><span class="pre">unscented_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ukf.html#unscented_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother" title="Link to this definition">#</a></dt>
<dd><p>Run a unscented Kalman (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="dynamax.nonlinear_gaussian_ssm.models.ParamsNLGSSM"><em>ParamsNLGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>hyperperams</strong> – hyper-parameters.</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional inputs.</p></li>
<li><p><strong>hyperparams</strong> (<em>UKFHyperParams</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id5">
<h2>Types<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsNLGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#ParamsNLGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM" title="Link to this definition">#</a></dt>
<dd><p>Parameters for a NLGSSM model.</p>
<p><div class="math notranslate nohighlight">
\[p(z_t | z_{t-1}, u_t) = N(z_t | f(z_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | z_t) = N(y_t | h(z_t, u_t), R_t)\]</div>

<div class="math notranslate nohighlight">
\[p(z_1) = N(z_1 | m, S)\]</div>
</p>
<p>If you have no inputs, the dynamics and emission functions do not to take <span class="math notranslate nohighlight">\(u_t\)</span> as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(f\)</span></p></li>
<li><p><strong>dynamics_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(Q\)</span></p></li>
<li><p><strong>emissions_function</strong> – <span class="math notranslate nohighlight">\(h\)</span></p></li>
<li><p><strong>emissions_covariance</strong> – <span class="math notranslate nohighlight">\(R\)</span></p></li>
<li><p><strong>initial_mean</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(m\)</span></p></li>
<li><p><strong>initial_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(S\)</span></p></li>
<li><p><strong>emission_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>emission_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="generalized-gaussian-gssm">
<h1>Generalized Gaussian GSSM<a class="headerlink" href="#generalized-gaussian-gssm" title="Link to this heading">#</a></h1>
<section id="id6">
<h2>High-level class<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GeneralizedGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM" title="Link to this definition">#</a></dt>
<dd><p>Generalized Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(z_t | z_{t-1}, u_t) = N(z_t | f(z_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | z_t) = q(y_t | h(z_t, u_t), R(z_t, u_t))\]</div>

<div class="math notranslate nohighlight">
\[p(z_1) = N(z_1 | m, S)\]</div>
</p>
<p>where the model parameters are</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_t\)</span> = hidden variables of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <cite>input_dim</cite> (defaults to 0).</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> = dynamics (transition) function</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> = emission (observation) function</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> = covariance matrix of dynamics (system) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> = covariance function for emission (observation) noise</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = mean of initial state</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> = covariance matrix of initial state</p></li>
</ul>
<p>The parameters of the model are stored in a separate object of type <a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.ParamsGGSSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamsGGSSM</span></code></a>.</p>
<p>For example usage, see <a class="github reference external" href="https://github.com/probml/dynamax/blob/main/dynamax/generalized_gaussian_ssm/models_test.py">probml/dynamax</a>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the emissions</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.covariates_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">covariates_shape</span></span><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.covariates_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the covariates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution" title="Link to this definition">#</a></dt>
<dd><p>Returns the initial distribution of the state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution" title="Link to this definition">#</a></dt>
<dd><p>Returns the transition distribution of the state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>)</p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution" title="Link to this definition">#</a></dt>
<dd><p>Returns the emission distribution of the state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>)</p></li>
<li><p><strong>state</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>)</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Distribution</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id7">
<h2>Low-level inference<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter">
<span class="sig-name descname"><span class="pre">conditional_moments_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#conditional_moments_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter" title="Link to this definition">#</a></dt>
<dd><p>Run an (iterated) conditional moments Gaussian filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>EKFIntegrals</em><em> | </em><em>UKFIntegrals</em><em> | </em><em>GHKFIntegrals</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optopnal array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter">
<span class="sig-name descname"><span class="pre">iterated_conditional_moments_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#iterated_conditional_moments_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter" title="Link to this definition">#</a></dt>
<dd><p>Run an iterated conditional moments Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>EKFIntegrals</em><em> | </em><em>UKFIntegrals</em><em> | </em><em>GHKFIntegrals</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optional array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother">
<span class="sig-name descname"><span class="pre">conditional_moments_gaussian_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#conditional_moments_gaussian_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother" title="Link to this definition">#</a></dt>
<dd><p>Run a conditional moments Gaussian smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>EKFIntegrals</em><em> | </em><em>UKFIntegrals</em><em> | </em><em>GHKFIntegrals</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optopnal array of inputs.</p></li>
<li><p><strong>filtered_posterior</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorGSSMFiltered"><em>PosteriorGSSMFiltered</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother">
<span class="sig-name descname"><span class="pre">iterated_conditional_moments_gaussian_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#iterated_conditional_moments_gaussian_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother" title="Link to this definition">#</a></dt>
<dd><p>Run an iterated conditional moments Gaussian smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<a class="reference internal" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="dynamax.generalized_gaussian_ssm.models.ParamsGGSSM"><em>ParamsGGSSM</em></a>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>EKFIntegrals</em><em> | </em><em>UKFIntegrals</em><em> | </em><em>GHKFIntegrals</em>) – inference parameters that specify how to compute moments.</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional number of linearizations around prior/posterior for update step (default 1).</p></li>
<li><p><strong>inputs</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>] </em><em>| </em><em>None</em>) – optopnal array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>posterior object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>post</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id8">
<h2>Types<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.ParamsGGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsGGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_mean_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_cov_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dist=&lt;function</span> <span class="pre">ParamsGGSSM.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#ParamsGGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM" title="Link to this definition">#</a></dt>
<dd><p>Container for Generalized Gaussian SSM parameters.
Specifically, it defines the following model:</p>
<p><div class="math notranslate nohighlight">
\[p(z_t | z_{t-1}, u_t) = N(z_t | f(z_{t-1}, u_t), Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t | z_t) = q(y_t | h(z_t, u_t), R(z_t, u_t))\]</div>

<div class="math notranslate nohighlight">
\[p(z_1) = N(z_1 | m, S)\]</div>
</p>
<p>This differs from NLGSSM in by allowing a general emission model.
If you have no inputs, the dynamics and emission functions do not to take <span class="math notranslate nohighlight">\(u_t\)</span> as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_mean</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(m\)</span></p></li>
<li><p><strong>initial_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(S\)</span></p></li>
<li><p><strong>dynamics_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(f\)</span>. This has the signature <span class="math notranslate nohighlight">\(f: Z * U -&gt; Y\)</span> or <span class="math notranslate nohighlight">\(h: Z -&gt; Y\)</span>.</p></li>
<li><p><strong>dynamics_covariance</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em>) – <span class="math notranslate nohighlight">\(Q\)</span></p></li>
<li><p><strong>emission_mean_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(h\)</span>. This has the signature <span class="math notranslate nohighlight">\(h: Z * U -&gt; Z\)</span> or <span class="math notranslate nohighlight">\(h: Z -&gt; Z\)</span>.</p></li>
<li><p><strong>emission_cov_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>]</em>) – <span class="math notranslate nohighlight">\(R\)</span>. This has the signature <span class="math notranslate nohighlight">\(R: Z * U -&gt; Z*Z\)</span> or <span class="math notranslate nohighlight">\(R: Z -&gt; Z*Z\)</span>.</p></li>
<li><p><strong>emission_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>]</em><em>, </em><em>Distribution</em><em>]</em>) – the observation distribution <span class="math notranslate nohighlight">\(q\)</span>. This is a callable that takes the predicted
mean and covariance of Y, and returns a tfp distribution object: <span class="math notranslate nohighlight">\(q: Z * (Z*Z) -&gt; Dist(Y)\)</span>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.utils.utils.find_permutation">
<span class="sig-name descname"><span class="pre">find_permutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/utils/utils.html#find_permutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.utils.utils.find_permutation" title="Link to this definition">#</a></dt>
<dd><p>Find the permutation of the state labels in sequence <code class="docutils literal notranslate"><span class="pre">z1</span></code> so that they
best align with the labels in <code class="docutils literal notranslate"><span class="pre">z2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z1</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps'</em><em>]</em>) – The first state vector.</p></li>
<li><p><strong>z2</strong> (<em>Int</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps'</em><em>]</em>) – The second state vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>permutation such that <code class="docutils literal notranslate"><span class="pre">jnp.take(perm,</span> <span class="pre">z1)</span></code> best aligns with <code class="docutils literal notranslate"><span class="pre">z2</span></code>.
Thus, <code class="docutils literal notranslate"><span class="pre">len(perm)</span> <span class="pre">=</span> <span class="pre">min(z1.max(),</span> <span class="pre">z2.max())</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="types.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Terminology for types</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">State Space Model (Base class)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM"><code class="docutils literal notranslate"><span class="pre">SSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">SSM.initial_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">SSM.transition_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">SSM.emission_distribution()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prior"><code class="docutils literal notranslate"><span class="pre">SSM.log_prior()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">SSM.emission_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.inputs_shape"><code class="docutils literal notranslate"><span class="pre">SSM.inputs_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.sample"><code class="docutils literal notranslate"><span class="pre">SSM.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prob"><code class="docutils literal notranslate"><span class="pre">SSM.log_prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.marginal_log_prob"><code class="docutils literal notranslate"><span class="pre">SSM.marginal_log_prob()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.filter"><code class="docutils literal notranslate"><span class="pre">SSM.filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.smoother"><code class="docutils literal notranslate"><span class="pre">SSM.smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.e_step"><code class="docutils literal notranslate"><span class="pre">SSM.e_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.m_step"><code class="docutils literal notranslate"><span class="pre">SSM.m_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_em"><code class="docutils literal notranslate"><span class="pre">SSM.fit_em()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_sgd"><code class="docutils literal notranslate"><span class="pre">SSM.fit_sgd()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.parameters.ParameterSet"><code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.parameters.PropertySet"><code class="docutils literal notranslate"><span class="pre">PropertySet</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.parameters.ParameterProperties"><code class="docutils literal notranslate"><span class="pre">ParameterProperties</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#hidden-markov-model">Hidden Markov Model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abstract-classes">Abstract classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-level-models">High-level models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-level-inference">Low-level inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types">Types</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-gaussian-ssm">Linear Gaussian SSM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-level-class">High-level class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.emission_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.inputs_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.initialize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.initial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.transition_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.emission_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.sample"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.sample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.marginal_log_prob()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.filter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.smoother()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_sample"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.posterior_sample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.posterior_predictive()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.e_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize_m_step_state"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.initialize_m_step_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.m_step"><code class="docutils literal notranslate"><span class="pre">LinearGaussianSSM.m_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Low-level inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_filter"><code class="docutils literal notranslate"><span class="pre">lgssm_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_smoother"><code class="docutils literal notranslate"><span class="pre">lgssm_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample"><code class="docutils literal notranslate"><span class="pre">lgssm_posterior_sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSM</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSMInitial</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSMDynamics</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions"><code class="docutils literal notranslate"><span class="pre">ParamsLGSSMEmissions</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMFiltered"><code class="docutils literal notranslate"><span class="pre">PosteriorGSSMFiltered</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorGSSMSmoothed"><code class="docutils literal notranslate"><span class="pre">PosteriorGSSMSmoothed</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-gaussian-gssm">Nonlinear Gaussian GSSM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">High-level class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.emission_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.inputs_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.initial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.transition_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">NonlinearGaussianSSM.emission_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Low-level inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter"><code class="docutils literal notranslate"><span class="pre">extended_kalman_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter"><code class="docutils literal notranslate"><span class="pre">iterated_extended_kalman_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother"><code class="docutils literal notranslate"><span class="pre">extended_kalman_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother"><code class="docutils literal notranslate"><span class="pre">iterated_extended_kalman_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter"><code class="docutils literal notranslate"><span class="pre">unscented_kalman_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother"><code class="docutils literal notranslate"><span class="pre">unscented_kalman_smoother()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.ParamsNLGSSM"><code class="docutils literal notranslate"><span class="pre">ParamsNLGSSM</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generalized-gaussian-gssm">Generalized Gaussian GSSM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">High-level class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.emission_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.covariates_shape"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.covariates_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.initial_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.transition_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution"><code class="docutils literal notranslate"><span class="pre">GeneralizedGaussianSSM.emission_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Low-level inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter"><code class="docutils literal notranslate"><span class="pre">conditional_moments_gaussian_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter"><code class="docutils literal notranslate"><span class="pre">iterated_conditional_moments_gaussian_filter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother"><code class="docutils literal notranslate"><span class="pre">conditional_moments_gaussian_smoother()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother"><code class="docutils literal notranslate"><span class="pre">iterated_conditional_moments_gaussian_smoother()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.ParamsGGSSM"><code class="docutils literal notranslate"><span class="pre">ParamsGGSSM</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#utilities">Utilities</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamax.utils.utils.find_permutation"><code class="docutils literal notranslate"><span class="pre">find_permutation()</span></code></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022, Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>