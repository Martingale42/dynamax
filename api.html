
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API &#8212; dynamax documentation</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.gif" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">dynamax documentation</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  HMMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/casino_hmm_inference.html">
   Casino HMM: Inference (state estimation)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/casino_hmm_learning.html">
   Casino HMM: learning (parameter estimation)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/gaussian_hmm.html">
   Gaussian HMM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/autoregressive_hmm.html">
   Autoregressive (AR) HMM Demo
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Linear Gaussian SSMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking.html">
   Tracking an object using the Kalman filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_linreg.html">
   Online linear regression using Kalman filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_parallel_inference.html">
   Parallel filtering and smoothing in an LG-SSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_learning.html">
   MAP parameter estimation for an LG-SSM using EM and SGD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/lgssm_hmc.html">
   Bayesian parameter estimation for an LG-SSM using HMC
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Nonlinear Gaussian SSMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_spiral.html">
   Tracking a spiraling object using the extended / unscented Kalman filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_ukf_pendulum.html">
   Tracking a 1d pendulum using Extended / Unscented Kalman filter/ smoother
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/nonlinear_gaussian_ssm/ekf_mlp.html">
   Online learning for an MLP using extended Kalman filtering
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Generalized Gaussian SSMs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_logistic_regression_demo.html">
   Online Logistic Regression using conditional moments Gaussian filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_mlp_classification_demo.html">
   Online learning of an MLP Classifier using conditional moments Gaussian filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html">
   Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#state-space-model-base-class">
   State Space Model (Base class)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#hidden-markov-model">
   Hidden Markov Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#linear-gaussian-ssm">
   Linear Gaussian SSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#nonlinear-gaussian-gssm">
   Nonlinear Gaussian GSSM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#generalized-gaussian-gssm">
   Generalized Gaussian GSSM
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/api.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   API
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#state-space-model-base-class">
   State Space Model (Base class)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamax.ssm.SSM">
     <code class="docutils literal notranslate">
      <span class="pre">
       SSM
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.emission_distribution()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.emission_shape">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.emission_shape
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_em">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.fit_em()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.fit_sgd">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.fit_sgd()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.initial_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.initial_distribution()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.inputs_shape">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.inputs_shape
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prior">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.log_prior()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.log_prob">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.log_prob()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.sample()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.ssm.SSM.transition_distribution">
       <code class="docutils literal notranslate">
        <span class="pre">
         SSM.transition_distribution()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hidden-markov-model">
   Hidden Markov Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#high-level-class">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM">
       <code class="docutils literal notranslate">
        <span class="pre">
         HMM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.e_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.e_step()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.filter">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.filter()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.initialize_m_step_state">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.initialize_m_step_state()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.log_prior">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.log_prior()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.marginal_log_prob">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.marginal_log_prob()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.most_likely_states">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.most_likely_states()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.smoother">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.smoother()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.HMM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           HMM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#low-level-inference">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_two_filter_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_two_filter_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_fixed_lag_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_fixed_lag_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_posterior_mode">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_posterior_mode()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.hidden_markov_model.hmm_posterior_sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         hmm_posterior_sample()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-gaussian-ssm">
   Linear Gaussian SSM
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         LinearGaussianSSM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.e_step()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.filter()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.initialize()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.inputs_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.log_prior">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.log_prior()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.marginal_log_prob()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.posterior_predictive()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.smoother()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           LinearGaussianSSM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         lgssm_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         lgssm_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         lgssm_posterior_sample()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types">
     Types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSM
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSMInitial
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSMDynamics
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions">
       <code class="docutils literal notranslate">
        <span class="pre">
         ParamsLGSSMEmissions
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMFiltered">
       <code class="docutils literal notranslate">
        <span class="pre">
         PosteriorLGSSMFiltered
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMSmoothed">
       <code class="docutils literal notranslate">
        <span class="pre">
         PosteriorLGSSMSmoothed
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nonlinear-gaussian-gssm">
   Nonlinear Gaussian GSSM
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         NonlinearGaussianSSM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.inputs_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           NonlinearGaussianSSM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         extended_kalman_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_extended_kalman_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         extended_kalman_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_extended_kalman_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         unscented_kalman_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         unscented_kalman_smoother()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-gaussian-gssm">
   Generalized Gaussian GSSM
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     High-level class
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM">
       <code class="docutils literal notranslate">
        <span class="pre">
         GeneralizedGaussianSSM
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.emission_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.emission_shape
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.initial_distribution()
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution">
         <code class="docutils literal notranslate">
          <span class="pre">
           GeneralizedGaussianSSM.transition_distribution()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Low-level inference
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         conditional_moments_gaussian_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_conditional_moments_gaussian_filter()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         conditional_moments_gaussian_smoother()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother">
       <code class="docutils literal notranslate">
        <span class="pre">
         iterated_conditional_moments_gaussian_smoother()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this heading">¶</a></h1>
</section>
<section id="state-space-model-base-class">
<h1>State Space Model (Base class)<a class="headerlink" href="#state-space-model-base-class" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.ssm.SSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SSM</span></span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM" title="Permalink to this definition">¶</a></dt>
<dd><p>A base class for state space models. Such models consist of parameters, which
we may learn, as well as hyperparameters, which specify static properties of the
model. This base class allows parameters to be indicated a standardized way
so that they can easily be converted to/from unconstrained form. It also uses
these parameters to implement the tree_flatten and tree_unflatten methods necessary
to register a model as a JAX PyTree.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.emission_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>PyTree</em>) – current latent state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.emission_shape">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.ssm.SSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s emissions.
For example, a Gaussian HMM with D dimensional emissions would return (D,).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.fit_em">
<span class="sig-name descname"><span class="pre">fit_em</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.fit_em"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.fit_em" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute parameter MLE/ MAP estimate using Expectation-Maximization (EM).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.fit_sgd">
<span class="sig-name descname"><span class="pre">fit_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">params,</span> <span class="pre">props,</span> <span class="pre">emissions,</span> <span class="pre">inputs=None,</span> <span class="pre">optimizer=GradientTransformation(init=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.init_fn&gt;,</span> <span class="pre">update=&lt;function</span> <span class="pre">chain.&lt;locals&gt;.update_fn&gt;),</span> <span class="pre">batch_size=1,</span> <span class="pre">num_epochs=50,</span> <span class="pre">shuffle=False,</span> <span class="pre">key=DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.fit_sgd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.fit_sgd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute parameter MLE/ MAP estimate using Stochastic gradient descent (SGD).</p>
<p>Fit this HMM by running SGD on the marginal log likelihood.
Note that batch_emissions is initially of shape (N,T)
where N is the number of independent sequences and
T is the length of a sequence. Then, a random susbet with shape (B, T)
of entire sequence, not time steps, is sampled at each step where B is
batch size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_emissions</strong> – Independent sequences.</p></li>
<li><p><strong>optmizer</strong> (<em>optax.Optimizer</em>) – Optimizer.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of sequences used at each update step.</p></li>
<li><p><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Iterations made through entire dataset.</p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Indicates whether to shuffle minibatches.</p></li>
<li><p><strong>key</strong> (<em>jr.PRNGKey</em>) – RNG key to shuffle minibatches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of loss_fn stored at each step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>losses</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.initial_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>distribution over initial latent state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.ssm.SSM.inputs_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.log_prior">
<span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log prior probability of any model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log prior probability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lp (Scalar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log joint probability of the states and observations</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a sequence of latent states and emissions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – rng key</p></li>
<li><p><strong>num_timesteps</strong> – length of sequence to generate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.ssm.SSM.transition_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/ssm.html#SSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.ssm.SSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>PyTree</em>) – current latent state</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hidden-markov-model">
<h1>Hidden Markov Model<a class="headerlink" href="#hidden-markov-model" title="Permalink to this heading">¶</a></h1>
<section id="high-level-class">
<h2>High-level class<a class="headerlink" href="#high-level-class" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_component</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Hidden Markov Model.</p>
</div></blockquote>
<p>The model is defined as follows
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">z_t</span><span class="o">=</span><span class="n">k</span> <span class="o">|</span> <span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">u_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span> <span class="n">t</span><span class="p">,</span> <span class="n">u_t</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">z_t</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">Pr</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">B</span><span class="p">(</span><span class="n">k</span><span class="p">;</span> <span class="n">t</span><span class="p">,</span> <span class="n">u_t</span><span class="p">))</span>
<span class="n">p</span><span class="p">(</span><span class="n">z_1</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">pi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(z_t\)</span> = discrete hidden variable with <code class="docutils literal notranslate"><span class="pre">num_states</span></code> possible values,
<span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <code class="docutils literal notranslate"><span class="pre">emission_dim</span></code>
<span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <code class="docutils literal notranslate"><span class="pre">input_dim</span></code> (defaults to 0).</p>
<p>The parameters of the model are stored in a separate named tuple, with these fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>pi = params.initial</p></li>
<li><p>A = params.transitions</p></li>
<li><p>B = params.emissions</p></li>
</ul>
</div></blockquote>
<p>Many possible emission distributions Pr() are supported. Each of these define a different
set of emission parameters B. For example, if we have a Gaussian HMM, then each discrete
state <span class="math notranslate nohighlight">\(k\)</span> is associated with a different mean <span class="math notranslate nohighlight">\(\mu_k\)</span> and covariance <span class="math notranslate nohighlight">\(\Sigma_k\)</span>.
Parameters may also be indexed by time <span class="math notranslate nohighlight">\(k\)</span>, and may also depend on inputs <span class="math notranslate nohighlight">\(u_t\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>initial_component</strong> (<em>HMMInitialState</em>) – </p></li>
<li><p><strong>transition_component</strong> (<em>HMMTransitions</em>) – </p></li>
<li><p><strong>emission_component</strong> (<em>HMMEmissions</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.e_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The E-step computes expected sufficient statistics under the
posterior. In the generic case, we simply return the posterior itself.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>PyTree</em>) – current latent state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s emissions.
For example, a Gaussian HMM with D dimensional emissions would return (D,).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute filtering distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>distribution over initial latent state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.initialize_m_step_state">
<span class="sig-name descname"><span class="pre">initialize_m_step_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.initialize_m_step_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.initialize_m_step_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize any required state for the M step.</p>
<p>For example, this might include the optimizer state for Adam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.log_prior">
<span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log prior probability of any model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log prior probability.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lp (Scalar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.marginal_log_prob">
<span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.marginal_log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log marginal likelihood of observations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.most_likely_states">
<span class="sig-name descname"><span class="pre">most_likely_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.most_likely_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.most_likely_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute most likely state path with the Viterbi algorithm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothing distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.HMM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/models/abstractions.html#HMM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.HMM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>PyTree</em>) – current latent state</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="low-level-inference">
<h2>Low-level inference<a class="headerlink" href="#low-level-inference" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_filter">
<span class="sig-name descname"><span class="pre">hmm_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>k</em>) – prob(hid(1)=k)</p></li>
<li><p><strong>transition_matrix</strong> (<em>j</em><em>,</em><em>k</em>) – prob(hid(t)=k | hid(t-1)=j)</p></li>
<li><p><strong>log_likelihoods</strong> (<em>t</em><em>,</em><em>k</em>) – p(obs(t) | hid(t)=k)</p></li>
<li><p><strong>transition_fn</strong> (<em>t</em>) – returns K*K transition matrix for step t (default None)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>HMMPosteriorFiltered</em></p>
</dd>
</dl>
<p>Returns: HMMPosterior object (smoothed_probs=None)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_smoother">
<span class="sig-name descname"><span class="pre">hmm_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_trans_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Computed the smoothed state probabilities using a general
Bayesian smoother.</p>
<p>Note: This is the discrete SSM analog of the RTS smoother for
linear Gaussian SSMs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>transition_matrix</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>log_likelihoods</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>compute_trans_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HMMPosterior object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>HMMPosterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_two_filter_smoother">
<span class="sig-name descname"><span class="pre">hmm_two_filter_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_trans_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_two_filter_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_two_filter_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Computed the smoothed state probabilities using the two-filter
smoother, a.k.a. the forward-backward algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>transition_matrix</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>log_likelihoods</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>compute_trans_probs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HMMPosterior object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>HMMPosterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_fixed_lag_smoother">
<span class="sig-name descname"><span class="pre">hmm_fixed_lag_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_fixed_lag_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_fixed_lag_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the smoothed state probabilities using the fixed-lag smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>k</em>) – prob(hid(1)=k)</p></li>
<li><p><strong>transition_matrix</strong> (<em>j</em><em>,</em><em>k</em>) – prob(hid(t)=k | hid(t-1)=j)</p></li>
<li><p><strong>log_likelihoods</strong> (<em>t</em><em>,</em><em>k</em>) – p(obs(t) | hid(t)=k)</p></li>
<li><p><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – size of smoothed window</p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HMMPosterior object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>HMMPosterior</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_posterior_mode">
<span class="sig-name descname"><span class="pre">hmm_posterior_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_posterior_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_posterior_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the most likely state sequence. This is called the Viterbi algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>_description_</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states'</em><em>]</em>) – </p></li>
<li><p><strong>transition_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states num_states'</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>log_likelihoods</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_timesteps num_states'</em><em>]</em>) – </p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Int</em>[Array, ‘num_timesteps’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.hidden_markov_model.hmm_posterior_sample">
<span class="sig-name descname"><span class="pre">hmm_posterior_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/hidden_markov_model/inference.html#hmm_posterior_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.hidden_markov_model.hmm_posterior_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a latent sequence from the posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_distribution</strong> (<em>k</em>) – prob(hid(1)=k)</p></li>
<li><p><strong>transition_matrix</strong> (<em>j</em><em>,</em><em>k</em>) – prob(hid(t)=k | hid(t-1)=j)</p></li>
<li><p><strong>log_likelihoods</strong> (<em>t</em><em>,</em><em>k</em>) – p(obs(t) | hid(t)=k)</p></li>
<li><p><strong>rng</strong> (<em>PRNGKey</em>) – </p></li>
<li><p><strong>transition_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><em>Callable</em></a><em>[</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'num_states num_states'</em><em>]</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log_prob
sampled_states(1:T)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Int</em>[Array, ‘num_timesteps’]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="linear-gaussian-ssm">
<h1>Linear Gaussian SSM<a class="headerlink" href="#linear-gaussian-ssm" title="Permalink to this heading">¶</a></h1>
<section id="id1">
<h2>High-level class<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_dynamics_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_emissions_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear Gaussian State Space Model.</p>
<p>The model is defined as follows</p>
<p><div class="math notranslate nohighlight">
\[p(x_1) = \mathcal{N}(x_1 \mid m, S)\]</div>

<div class="math notranslate nohighlight">
\[p(x_t \mid x_{t-1}, u_t) = \mathcal{N}(x_t \mid F_t x_{t-1} + B_t u_t + b_t, Q_t)\]</div>

<div class="math notranslate nohighlight">
\[p(y_t \mid x_t) = \mathcal{N}(y_t \mid H_t x_t + D_t u_t + d_t, R_t)\]</div>
</p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_t\)</span> is a latent state of size <cite>state_dim</cite>,</p></li>
<li><p><span class="math notranslate nohighlight">\(y_t\)</span> is an emission of size <cite>emission_dim</cite></p></li>
<li><p><span class="math notranslate nohighlight">\(u_t\)</span> is an input of size <cite>input_dim</cite> (defaults to 0)</p></li>
</ul>
<p>The parameters of the model are stored in a <a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.ParamsLGSSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamsLGSSM</span></code></a>.
You can create the parameters manually, or by calling <a class="reference internal" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize" title="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step">
<span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.e_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.e_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The E-step computes sums of expected sufficient statistics under the
posterior. In the generic case, we simply return the posterior itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'nseq ntime emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'nseq ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>PyTree</em>) – current latent state.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s emissions.
For example, a Gaussian HMM with D dimensional emissions would return (D,).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute filtering distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorLGSSMFiltered"><em>PosteriorLGSSMFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>distribution over initial latent state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dist (tfd.Distribution)</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DeviceArray([0,</span> <span class="pre">0],</span> <span class="pre">dtype=uint32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_input_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_input_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_covariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model parameters and their corresponding properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>PRNGKey</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>, <a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.inputs_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.log_prior">
<span class="sig-name descname"><span class="pre">log_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.log_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log prior probability of model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">marginal_log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.marginal_log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.marginal_log_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute log marginal likelihood of observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">posterior_predictive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.posterior_predictive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.posterior_predictive" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute marginal posterior predictive for each observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(T,D) array of E[Y(t,d) | Y(1:T)]
stds: (T,D) array std[Y(t,d) | Y(1:T)]</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>means</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute smoothing distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMSmoothed" title="dynamax.linear_gaussian_ssm.inference.PosteriorLGSSMSmoothed"><em>PosteriorLGSSMSmoothed</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/models.html#LinearGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.LinearGaussianSSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>PyTree</em>) – current latent state</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id2">
<h2>Low-level inference<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_filter">
<span class="sig-name descname"><span class="pre">lgssm_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a Kalman filter to produce the marginal likelihood and filtered state
estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – model parameters</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMFiltered" title="dynamax.linear_gaussian_ssm.inference.PosteriorLGSSMFiltered"><em>PosteriorLGSSMFiltered</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_smoother">
<span class="sig-name descname"><span class="pre">lgssm_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run forward-filtering, backward-smoother to compute expectations
under the posterior distribution on latent states. Technically, this
implements the Rauch-Tung-Striebel (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – an LGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – array of observations.</p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMSmoothed" title="dynamax.linear_gaussian_ssm.inference.PosteriorLGSSMSmoothed"><em>PosteriorLGSSMSmoothed</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.lgssm_posterior_sample">
<span class="sig-name descname"><span class="pre">lgssm_posterior_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#lgssm_posterior_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.lgssm_posterior_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Run forward-filtering, backward-sampling to draw samples from <span class="math notranslate nohighlight">\(p(x_{1:T} | y_{1:T}, u_{1:T})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>PRNGKey</em>) – </p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSM"><em>ParamsLGSSM</em></a>) – </p></li>
<li><p><strong>emissions</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime emission_dim'</em><em>]</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>one sample of <span class="math notranslate nohighlight">\(x_{1:T}\)</span> from the posterior distribution on latent states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>states</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="types">
<h2>Types<a class="headerlink" href="#types" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of a linear Gaussian SSM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMInitial"><em>ParamsLGSSMInitial</em></a>) – initial distribution parameters</p></li>
<li><p><strong>dynamics</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMDynamics"><em>ParamsLGSSMDynamics</em></a>) – dynamics distribution parameters</p></li>
<li><p><strong>emissions</strong> (<a class="reference internal" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions" title="dynamax.linear_gaussian_ssm.inference.ParamsLGSSMEmissions"><em>ParamsLGSSMEmissions</em></a>) – emission distribution parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMInitial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMInitial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMInitial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMInitial" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the initial distribution</p>
<p><div class="math notranslate nohighlight">
\[p(x_1) = \mathcal{N}(x_1 \mid \mu_1, Q_1)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – <span class="math notranslate nohighlight">\(\mu_1\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – <span class="math notranslate nohighlight">\(Q_1\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMDynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the emission distribution</p>
<p><div class="math notranslate nohighlight">
\[p(x_{t+1} \mid x_t, u_t) = \mathcal{N}(x_{t+1} \mid Ax_t + B u_t + b, Q)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – dynamics weights <span class="math notranslate nohighlight">\(A\)</span></p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – dynamics bias <span class="math notranslate nohighlight">\(b\)</span></p></li>
<li><p><strong>input_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim input_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – dynamics input weights <span class="math notranslate nohighlight">\(B\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'state_dim state_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – dynamics covariance <span class="math notranslate nohighlight">\(Q\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ParamsLGSSMEmissions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#ParamsLGSSMEmissions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.ParamsLGSSMEmissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters of the emission distribution</p>
<p><div class="math notranslate nohighlight">
\[p(y_t \mid x_t, u_t) = \mathcal{N}(y_t \mid Cx_t + D u_t + d, R)\]</div>
</p>
<p>The tuple doubles as a container for the ParameterProperties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim state_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – emission weights <span class="math notranslate nohighlight">\(C\)</span></p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – emission bias <span class="math notranslate nohighlight">\(d\)</span></p></li>
<li><p><strong>input_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim input_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – emission input weights <span class="math notranslate nohighlight">\(D\)</span></p></li>
<li><p><strong>cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><em>Union</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'emission_dim emission_dim'</em><em>]</em><em>, </em><em>ParameterProperties</em><em>]</em>) – emission covariance <span class="math notranslate nohighlight">\(R\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.PosteriorLGSSMFiltered">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PosteriorLGSSMFiltered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_covariances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#PosteriorLGSSMFiltered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMFiltered" title="Permalink to this definition">¶</a></dt>
<dd><p>Marginals of the Gaussian filtering posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>) – marginal log likelihood, <span class="math notranslate nohighlight">\(p(y_{1:T} \mid u_{1:T})\)</span></p></li>
<li><p><strong>filtered_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of filtered means <span class="math notranslate nohighlight">\(\mathbb{E}[x_t | y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>filtered_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of filtered covariances <span class="math notranslate nohighlight">\(\mathrm{Cov}[x_t | y_{1:t}, u_{1:t}]\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynamax.linear_gaussian_ssm.PosteriorLGSSMSmoothed">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PosteriorLGSSMSmoothed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginal_loglik</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed_cross_covariances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/linear_gaussian_ssm/inference.html#PosteriorLGSSMSmoothed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.linear_gaussian_ssm.PosteriorLGSSMSmoothed" title="Permalink to this definition">¶</a></dt>
<dd><p>Marginals of the Gaussian filtering and smoothing posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginal_loglik</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>''</em><em>]</em>) – marginal log likelihood, <span class="math notranslate nohighlight">\(p(y_{1:T} \mid u_{1:T})\)</span></p></li>
<li><p><strong>filtered_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of filtered means <span class="math notranslate nohighlight">\(\mathbb{E}[x_t | y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>filtered_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of filtered covariances <span class="math notranslate nohighlight">\(\mathrm{Cov}[x_t | y_{1:t}, u_{1:t}]\)</span></p></li>
<li><p><strong>smoothed_means</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim'</em><em>]</em>) – array of smoothed means <span class="math notranslate nohighlight">\(\mathbb{E}[x_t | y_{1:T}, u_{1:T}]\)</span></p></li>
<li><p><strong>smoothed_covariances</strong> (<em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em>) – array of smoothed marginal covariances, <span class="math notranslate nohighlight">\(\mathrm{Cov}[x_t | y_{1:T}, u_{1:T}]\)</span></p></li>
<li><p><strong>smoothed_cross_covariances</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'ntime state_dim state_dim'</em><em>]</em><em>]</em>) – array of smoothed cross products, <span class="math notranslate nohighlight">\(\mathbb{E}[x_t x_{t+1}^T | y_{1:T}, u_{1:T}]\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="nonlinear-gaussian-gssm">
<h1>Nonlinear Gaussian GSSM<a class="headerlink" href="#nonlinear-gaussian-gssm" title="Permalink to this heading">¶</a></h1>
<section id="id3">
<h2>High-level class<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NonlinearGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Nonlinear Gaussian State Space Model.</p>
</div></blockquote>
<p>The model is defined as follows
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">u_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">f</span><span class="p">(</span><span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">u_t</span><span class="p">),</span> <span class="n">Q_t</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">z_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">h</span><span class="p">(</span><span class="n">z_t</span><span class="p">,</span> <span class="n">u_t</span><span class="p">),</span> <span class="n">R_t</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">z_1</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">z_1</span> <span class="o">|</span> <span class="n">m</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(z_t\)</span> = hidden variables of size <code class="docutils literal notranslate"><span class="pre">state_dim</span></code>,
<span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <code class="docutils literal notranslate"><span class="pre">emission_dim</span></code>
<span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <code class="docutils literal notranslate"><span class="pre">input_dim</span></code> (defaults to 0).</p>
<p>Alternatively, if you have no inputs, we can use the following, simpler model:
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">u_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">f</span><span class="p">(</span><span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">}),</span> <span class="n">Q_t</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">z_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">h</span><span class="p">(</span><span class="n">z_t</span><span class="p">),</span> <span class="n">R_t</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">z_1</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">z_1</span> <span class="o">|</span> <span class="n">m</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameters of the model are stored in a separate named tuple, with these fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>f = params.dynamics_function</p></li>
<li><p>Q = params.dynamics_covariance</p></li>
<li><p>h = params.emissions_function</p></li>
<li><p>R = params.emissions_covariance</p></li>
<li><p>m = params.init_mean</p></li>
<li><p>S = params.initial_covariance</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>emission_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>PyTree</em>) – current latent state.</p></li>
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s emissions.
For example, a Gaussian HMM with D dimensional emissions would return (D,).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>distribution over initial latent state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dist (tfd.Distribution)</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs_shape</span></span><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.inputs_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s inputs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/models.html#NonlinearGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.NonlinearGaussianSSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>PyTree</em>) – current latent state</p></li>
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id4">
<h2>Low-level inference<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.extended_kalman_filter">
<span class="sig-name descname"><span class="pre">extended_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#extended_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an (iterated) extended Kalman filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – an NLGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around posterior for update step.</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing,</dt><dd><p>marginal_log_lik
filtered_means (T, D_hid)
filtered_covariances (T, D_hid, D_hid)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter">
<span class="sig-name descname"><span class="pre">iterated_extended_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#iterated_extended_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated extended Kalman filter (IEKF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – an NLGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around smoothed posterior.</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing,</dt><dd><p>marginal_log_lik
filtered_means (T, D_hid)
filtered_covariances (T, D_hid, D_hid)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother">
<span class="sig-name descname"><span class="pre">extended_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#extended_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.extended_kalman_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an extended Kalman (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – an NLGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>filtered_posterior</strong> (<em>GSSMPosterior</em>) – filtered posterior to use for smoothing.</p></li>
<li><p><strong>None</strong> (<em>If</em>) – </p></li>
<li><p><strong>directly.</strong> (<em>the smoother computes the filtered posterior</em>) – </p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>GSSMPosterior instance containing properties of
filtered and smoothed posterior distributions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother">
<span class="sig-name descname"><span class="pre">iterated_extended_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ekf.html#iterated_extended_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.iterated_extended_kalman_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated extended Kalman smoother (IEKS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – an NLGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of re-linearizations around smoothed posterior.</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing properties of</dt><dd><p>filtered and smoothed posterior distributions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter">
<span class="sig-name descname"><span class="pre">unscented_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ukf.html#unscented_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a unscented Kalman filter to produce the marginal likelihood and
filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – an NLGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>hyperperams</strong> – a UKFHyperParams instance</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
<li><p><strong>hyperparams</strong> (<em>UKFHyperParams</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>ESSMPosterior instance containing,</dt><dd><p>marginal_log_lik
filtered_means (T, D_hid)
filtered_covariances (T, D_hid, D_hid)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother">
<span class="sig-name descname"><span class="pre">unscented_kalman_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/nonlinear_gaussian_ssm/inference_ukf.html#unscented_kalman_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.nonlinear_gaussian_ssm.unscented_kalman_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a unscented Kalman (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsNLGSSM</em>) – an NLGSSMParams instance (or object with the same fields)</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>hyperperams</strong> – a UKFHyperParams instance</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
<li><p><strong>hyperparams</strong> (<em>UKFHyperParams</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing properties of</dt><dd><p>filtered and smoothed posterior distributions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="generalized-gaussian-gssm">
<h1>Generalized Gaussian GSSM<a class="headerlink" href="#generalized-gaussian-gssm" title="Permalink to this heading">¶</a></h1>
<section id="id5">
<h2>High-level class<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GeneralizedGaussianSSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emission_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Generalized Gaussian State Space Model.</p>
</div></blockquote>
<p>The model is defined as follows
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">u_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">f</span><span class="p">(</span><span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">u_t</span><span class="p">),</span> <span class="n">Q_t</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">z_t</span><span class="p">)</span> <span class="o">=</span> <span class="n">Pr</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">h</span><span class="p">(</span><span class="n">z_t</span><span class="p">,</span> <span class="n">u_t</span><span class="p">),</span> <span class="n">R</span><span class="p">(</span><span class="n">z_t</span><span class="p">,</span> <span class="n">u_t</span><span class="p">))</span>
<span class="n">p</span><span class="p">(</span><span class="n">z_1</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">z_1</span> <span class="o">|</span> <span class="n">m</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(z_t\)</span> = hidden variables of size <code class="docutils literal notranslate"><span class="pre">state_dim</span></code>,
<span class="math notranslate nohighlight">\(y_t\)</span> = observed variables of size <code class="docutils literal notranslate"><span class="pre">emission_dim</span></code>
<span class="math notranslate nohighlight">\(u_t\)</span> = input covariates of size <code class="docutils literal notranslate"><span class="pre">input_dim</span></code> (defaults to 0).</p>
<p>The parameters of the model are stored in a separate named tuple, with these fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>f = params.dynamics_function</p></li>
<li><p>Q = params.dynamics_covariance</p></li>
<li><p>h = params.emissions_mean_function</p></li>
<li><p>R = params.emissions_cov_function</p></li>
<li><p>Pr = params.emission_dist</p></li>
<li><p>m = params.init_mean</p></li>
<li><p>S = params.initial_covariance</p></li>
</ul>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution">
<span class="sig-name descname"><span class="pre">emission_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.emission_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over emissions given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>PyTree</em>) – current latent state.</p></li>
<li><p><strong>params</strong> (<em>ParamsGGSSM</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of current emission.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">emission_shape</span></span><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.emission_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pytree matching the pytree of tuples specifying the shape(s)
of a single time step’s emissions.
For example, a Gaussian HMM with D dimensional emissions would return (D,).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution">
<span class="sig-name descname"><span class="pre">initial_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.initial_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.initial_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an initial distribution over latent states.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>distribution over initial latent state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dist (tfd.Distribution)</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParamsGGSSM</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution">
<span class="sig-name descname"><span class="pre">transition_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/models.html#GeneralizedGaussianSSM.transition_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.GeneralizedGaussianSSM.transition_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution over next latent state given current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>PyTree</em>) – current latent state</p></li>
<li><p><strong>params</strong> (<em>ParamsGGSSM</em>) – </p></li>
<li><p><strong>inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><em>Optional</em></a><em>[</em><em>Float</em><em>[</em><em>Array</em><em>, </em><em>'input_dim'</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>conditional distribution of next latent state.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dist (tfd.Distribution)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id6">
<h2>Low-level inference<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter">
<span class="sig-name descname"><span class="pre">conditional_moments_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#conditional_moments_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an (iterated) conditional moments Gaussian filter to produce the
marginal likelihood and filtered state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<em>GGSSMParams</em>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>CMGFIntegrals</em>) – inference parameters.</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around prior/posterior for update step.</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing,</dt><dd><p>marginal_log_lik
filtered_means (T, D_hid)
filtered_covariances (T, D_hid, D_hid)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter">
<span class="sig-name descname"><span class="pre">iterated_conditional_moments_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#iterated_conditional_moments_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated conditional moments Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<em>GGSSMParams</em>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>CMGFIntegrals</em>) – inference parameters.</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of linearizations around smoothed posterior.</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing,</dt><dd><p>marginal_log_lik
filtered_means (T, D_hid)
filtered_covariances (T, D_hid, D_hid)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother">
<span class="sig-name descname"><span class="pre">conditional_moments_gaussian_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#conditional_moments_gaussian_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.conditional_moments_gaussian_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a conditional moments Gaussian smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<em>GGSSMParams</em>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>CMGFIntegrals</em>) – inference parameters.</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>filtered_posterior</strong> (<em>GSSMPosterior</em>) – filtered posterior to use for smoothing.</p></li>
<li><p><strong>None</strong> (<em>If</em>) – </p></li>
<li><p><strong>directly.</strong> (<em>the smoother computes the filtered posterior</em>) – </p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>GSSMPosterior instance containing properties of
filtered and smoothed posterior distributions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother">
<span class="sig-name descname"><span class="pre">iterated_conditional_moments_gaussian_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emissions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamax/generalized_gaussian_ssm/inference.html#iterated_conditional_moments_gaussian_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamax.generalized_gaussian_ssm.iterated_conditional_moments_gaussian_smoother" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iterated conditional moments Gaussian smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_params</strong> (<em>GGSSMParams</em>) – model parameters.</p></li>
<li><p><strong>inf_params</strong> (<em>CMGFIntegrals</em>) – inference parameters.</p></li>
<li><p><strong>emissions</strong> (<em>T</em><em>,</em><em>D_hid</em>) – array of observations.</p></li>
<li><p><strong>num_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of re-linearizations around smoothed posterior.</p></li>
<li><p><strong>inputs</strong> (<em>T</em><em>,</em><em>D_in</em>) – array of inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>GSSMPosterior instance containing properties of</dt><dd><p>filtered and smoothed posterior distributions.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nlgssm_posterior</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="notebooks/generalized_gaussian_ssm/cmgf_poisson_demo.html" title="previous page">Fitting an LDS with Poisson Likelihood using conditional moments Gaussian filter</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy<br/>
        
            &copy; Copyright 2022, Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>